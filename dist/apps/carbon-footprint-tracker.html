<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2026-01-03T08:25:49.233903Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carbon Footprint Tracker</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --accent: #28a745;
            --danger: #dc3545;
            --border: #dee2e6;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        [data-theme="dark"] {
            --bg-primary: #212529;
            --bg-secondary: #343a40;
            --text-primary: #ffffff;
            --text-secondary: #adb5bd;
            --accent: #20c997;
            --danger: #e83e8c;
            --border: #495057;
        }
        * {
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 1rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.3s ease;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border);
        }
        h1 {
            margin: 0;
            font-size: 1.8rem;
            font-weight: 600;
        }
        .controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        .btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border);
            background: var(--bg-primary);
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .btn:hover {
            background: var(--bg-secondary);
            transform: translateY(-1px);
        }
        .btn-primary {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }
        .btn-danger {
            background: var(--danger);
            color: white;
            border-color: var(--danger);
        }
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-radius: 12px;
        }
        .input-row {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1rem;
            align-items: end;
        }
        @media (max-width: 768px) {
            .input-row {
                grid-template-columns: 1fr;
            }
        }
        input, select, textarea {
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: border-color 0.2s;
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(40,167,69,0.1);
        }
        .totals {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .total-card {
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-radius: 12px;
            text-align: center;
            border-left: 4px solid var(--accent);
        }
        .total-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent);
            margin: 0.25rem 0;
        }
        .entries {
            margin-bottom: 2rem;
        }
        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        .entry {
            display: grid;
            grid-template-columns: 80px 1fr auto auto;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            align-items: center;
        }
        @media (max-width: 768px) {
            .entry {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }
        }
        .category-icon {
            font-size: 2rem;
            width: 80px;
            text-align: center;
        }
        .chart-container {
            height: 300px;
            margin-bottom: 2rem;
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            align-items: flex-end;
            position: relative;
        }
        .tips {
            background: var(--accent);
            color: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }
        .hidden {
            display: none;
        }
        canvas {
            max-height: 100%;
            width: 100%;
        }
        dialog {
            border: none;
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90vw;
            box-shadow: var(--shadow);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üå± Carbon Footprint Tracker</h1>
            <div class="controls">
                <button class="btn" id="toggleDark" aria-label="Toggle dark mode">üåô</button>
                <button class="btn btn-primary" id="exportBtn">Export JSON</button>
                <button class="btn" id="importBtn">Import</button>
                <button class="btn" id="shareBtn">Share</button>
            </div>
        </header>

        <div class="totals">
            <div class="total-card">
                <div class="total-value" id="weekTotal">0</div>
                <div>Week</div>
            </div>
            <div class="total-card">
                <div class="total-value" id="monthTotal">0</div>
                <div>Month</div>
            </div>
            <div class="total-card">
                <div class="total-value" id="allTotal">0</div>
                <div>All Time</div>
            </div>
            <div class="total-card">
                <div class="total-value" id="avgCompare">0%</div>
                <div>vs Average</div>
            </div>
        </div>

        <div class="input-group">
            <div class="input-row">
                <div>
                    <label for="date">Date</label>
                    <input type="date" id="date" required>
                </div>
                <div>
                    <label for="category">Category</label>
                    <select id="category" required>
                        <option value="">Select...</option>
                        <option value="transportation">üöó Transportation</option>
                        <option value="energy">‚ö° Energy</option>
                        <option value="food">üçé Food</option>
                        <option value="waste">üóëÔ∏è Waste</option>
                        <option value="shopping">üõí Shopping</option>
                    </select>
                </div>
                <div>
                    <label for="co2">CO‚ÇÇ (kg)</label>
                    <input type="number" id="co2" step="0.01" min="0" required>
                </div>
            </div>
            <div>
                <label for="description">Description</label>
                <textarea id="description" rows="2" placeholder="e.g., 10km drive, 5kWh electricity, steak dinner..."></textarea>
            </div>
            <button class="btn btn-primary" id="addEntry" style="width: 200px; margin: 0 auto;">Add Entry</button>
        </div>

        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
            <input type="date" id="filterStart" style="padding: 0.5rem;">
            <input type="date" id="filterEnd" style="padding: 0.5rem;">
            <select id="filterCategory">
                <option value="">All Categories</option>
                <option value="transportation">Transportation</option>
                <option value="energy">Energy</option>
                <option value="food">Food</option>
                <option value="waste">Waste</option>
                <option value="shopping">Shopping</option>
            </select>
            <button class="btn" id="clearFilters">Clear Filters</button>
        </div>

        <div class="chart-container" id="chartContainer" role="img" aria-label="Emissions breakdown by category">
            <canvas id="chart" width="800" height="300"></canvas>
        </div>

        <div class="tips" id="tips">
            <h3>üí° Sustainability Tips</h3>
            <div id="tipContent">Add some entries to see personalized tips!</div>
        </div>

        <div class="entries">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h3>Recent Entries (<span id="entryCount">0</span>)</h3>
                <div>
                    <button class="btn" id="saveBtn">üíæ Save</button>
                    <button class="btn btn-danger" id="clearAll">Clear All</button>
                </div>
            </div>
            <div id="entriesList"></div>
        </div>
    </div>

    <dialog id="confirmDialog">
        <h3>Confirm Delete</h3>
        <p>Are you sure you want to delete all data?</p>
        <div style="display: flex; gap: 1rem; justify-content: flex-end;">
            <button class="btn" id="cancelDelete">Cancel</button>
            <button class="btn btn-danger" id="confirmDelete">Delete All</button>
        </div>
    </dialog>

    <input type="file" id="importFile" accept=".json" style="display: none;">

    <script>
        class CarbonTracker {
            constructor() {
                this.entries = [];
                this.categories = {
                    transportation: { icon: 'üöó', color: '#007bff' },
                    energy: { icon: '‚ö°', color: '#ffc107' },
                    food: { icon: 'üçé', color: '#28a745' },
                    waste: { icon: 'üóëÔ∏è', color: '#6c757d' },
                    shopping: { icon: 'üõí', color: '#fd7e14' }
                };
                this.loadData();
                this.initEventListeners();
                this.updateDisplay();
                this.setToday();
                this.toggleDarkMode();
            }

            setToday() {
                const today = new Date();
                today.setHours(0,0,0,0);
                document.getElementById('date').value = today.toISOString().split('T')[0];
            }

            initEventListeners() {
                document.getElementById('addEntry').addEventListener('click', () => this.addEntry());
                document.getElementById('exportBtn').addEventListener('click', () => this.exportData());
                document.getElementById('importBtn').addEventListener('click', () => this.importData());
                document.getElementById('shareBtn').addEventListener('click', () => this.shareData());
                document.getElementById('clearAll').addEventListener('click', () => this.showClearConfirm());
                document.getElementById('saveBtn').addEventListener('click', () => this.saveData());
                document.getElementById('toggleDark').addEventListener('click', () => this.toggleDarkMode());
                document.getElementById('clearFilters').addEventListener('click', () => this.clearFilters());
                document.getElementById('filterStart').addEventListener('change', () => this.filterEntries());
                document.getElementById('filterEnd').addEventListener('change', () => this.filterEntries());
                document.getElementById('filterCategory').addEventListener('change', () => this.filterEntries());

                document.getElementById('confirmDelete').addEventListener('click', () => this.clearAllData());
                document.getElementById('cancelDelete').addEventListener('click', () => {
                    document.getElementById('confirmDialog').close();
                });

                document.getElementById('importFile').addEventListener('change', (e) => this.handleImport(e));

                // Keyboard navigation
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && e.target.matches('input, select, textarea')) {
                        this.addEntry();
                    }
                });
            }

            addEntry() {
                const date = document.getElementById('date').value;
                const category = document.getElementById('category').value;
                const co2 = parseFloat(document.getElementById('co2').value);
                const description = document.getElementById('description').value.trim();

                if (!date || !category || isNaN(co2) || co2 <= 0) {
                    alert('Please fill all fields with valid values');
                    return;
                }

                const entry = {
                    id: Date.now().toString(),
                    date: new Date(date),
                    category,
                    co2,
                    description
                };

                this.entries.unshift(entry);
                this.saveData();
                this.updateDisplay();
                this.clearForm();
            }

            clearForm() {
                document.getElementById('description').value = '';
                document.getElementById('co2').value = '';
                this.setToday();
                document.getElementById('category').value = '';
                document.getElementById('description').focus();
            }

            updateDisplay() {
                this.updateTotals();
                this.renderEntries();
                this.renderChart();
                this.updateTips();
                document.getElementById('entryCount').textContent = this.entries.length;
            }

            updateTotals() {
                const now = new Date();
                const weekStart = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);

                const weekTotal = this.entries
                    .filter(e => e.date >= weekStart)
                    .reduce((sum, e) => sum + e.co2, 0);
                
                const monthTotal = this.entries
                    .filter(e => e.date >= monthStart)
                    .reduce((sum, e) => sum + e.co2, 0);

                const allTotal = this.entries.reduce((sum, e) => sum + e.co2, 0);

                // Average household baseline: ~20kg/week, ~80kg/month
                const avgWeek = 20;
                const avgCompare = allTotal > avgWeek ? Math.round((allTotal / avgWeek) * 100) : 0;

                document.getElementById('weekTotal').textContent = weekTotal.toFixed(1);
                document.getElementById('monthTotal').textContent = monthTotal.toFixed(1);
                document.getElementById('allTotal').textContent = allTotal.toFixed(1);
                document.getElementById('avgCompare').textContent = avgCompare + '%';
            }

            renderEntries() {
                const container = document.getElementById('entriesList');
                const filtered = this.getFilteredEntries();
                
                container.innerHTML = filtered.map(entry => `
                    <div class="entry" data-id="${entry.id}" tabindex="0" role="button" aria-label="Delete entry: ${entry.description}">
                        <div class="category-icon" style="color: ${this.categories[entry.category].color}">
                            ${this.categories[entry.category].icon}
                        </div>
                        <div>
                            <div><strong>${entry.description || 'No description'}</strong></div>
                            <div style="font-size: 0.9rem; color: var(--text-secondary);">
                                ${entry.date.toLocaleDateString()} ‚Ä¢ ${entry.co2.toFixed(2)}kg CO‚ÇÇ
                            </div>
                        </div>
                        <div style="font-weight: bold; color: ${this.categories[entry.category].color};">
                            ${this.categories[entry.category].icon} ${entry.category.replace(/^\w/, c => c.toUpperCase())}
                        </div>
                        <button class="btn btn-danger" onclick="tracker.deleteEntry('${entry.id}')" aria-label="Delete this entry">üóëÔ∏è</button>
                    </div>
                `).join('');

                // Add delete listeners
                container.querySelectorAll('.entry').forEach(entry => {
                    entry.addEventListener('keydown', (e) => {
                        if (e.key === 'Delete') {
                            const id = entry.dataset.id;
                            this.deleteEntry(id);
                        }
                    });
                });
            }

            getFilteredEntries() {
                const start = document.getElementById('filterStart').value ? 
                    new Date(document.getElementById('filterStart').value) : null;
                const end = document.getElementById('filterEnd').value ? 
                    new Date(document.getElementById('filterEnd').value) : null;
                const category = document.getElementById('filterCategory').value;

                return this.entries.filter(entry => {
                    let pass = true;
                    if (start && entry.date < start) pass = false;
                    if (end && entry.date > end) pass = false;
                    if (category && entry.category !== category) pass = false;
                    return pass;
                }).sort((a, b) => b.date - a.date);
            }

            renderChart() {
                const filtered = this.getFilteredEntries();
                const ctx = document.getElementById('chart').getContext('2d');
                const categoryTotals = {};
                
                filtered.forEach(entry => {
                    categoryTotals[entry.category] = (categoryTotals[entry.category] || 0) + entry.co2;
                });

                const maxValue = Math.max(...Object.values(categoryTotals), 1);
                const barWidth = 60;
                const gap = 20;
                const startX = 50;

                ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
                
                Object.entries(categoryTotals).forEach(([cat, value], i) => {
                    const barHeight = (value / maxValue) * 250;
                    const x = startX + i * (barWidth + gap);
                    
                    ctx.fillStyle = this.categories[cat].color;
                    ctx.fillRect(x, ctx.canvas.height - barHeight - 20, barWidth, barHeight);
                    
                    ctx.fillStyle = 'white';
                    ctx.font = 'bold 12px sans-serif';
                    ctx.textAlign = 'center';
                    ctx.fillText(value.toFixed(1), x + barWidth/2, ctx.canvas.height - barHeight - 25);
                    
                    ctx.fillStyle = this.categories[cat].color;
                    ctx.fillText(this.categories[cat].icon, x + barWidth/2, ctx.canvas.height - 5);
                });
            }

            updateTips() {
                const weekTotals = {};
                const now = new Date();
                const weekStart = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                
                this.entries
                    .filter(e => e.date >= weekStart)
                    .forEach(e => {
                        weekTotals[e.category] = (weekTotals[e.category] || 0) + e.co2;
                    });

                const topCategory = Object.entries(weekTotals)
                    .sort((a, b) => b[1] - a[1])[0]?.[0];

                const tips = {
                    transportation: 'Try carpooling, biking, or public transit. Walk for short trips!',
                    energy: 'Switch to LED bulbs and unplug devices. Consider renewable energy plans.',
                    food: 'Eat more plant-based meals. Reduce food waste with meal planning.',
                    waste: 'Recycle properly and reduce single-use plastics. Compost organic waste.',
                    shopping: 'Buy second-hand when possible. Choose quality over quantity.'
                };

                const tipEl = document.getElementById('tipContent');
                if (topCategory && tips[topCategory]) {
                    tipEl.innerHTML = `
                        <strong>${this.categories[topCategory].icon} ${topCategory.toUpperCase()}: ${weekTotals[topCategory].toFixed(1)}kg</strong><br>
                        ${tips[topCategory]}
                    `;
                } else {
                    tipEl.textContent = 'Add some entries to see personalized tips!';
                }
            }

            deleteEntry(id) {
                this.entries = this.entries.filter(e => e.id !== id);
                this.saveData();
                this.updateDisplay();
            }

            clearFilters() {
                document.getElementById('filterStart').value = '';
                document.getElementById('filterEnd').value = '';
                document.getElementById('filterCategory').value = '';
                this.filterEntries();
            }

            filterEntries() {
                this.renderEntries();
                this.renderChart();
            }

            saveData() {
                localStorage.setItem('carbon-tracker', JSON.stringify(this.entries));
            }

            loadData() {
                const data = localStorage.getItem('carbon-tracker');
                if (data) {
                    this.entries = JSON.parse(data).map(e => ({
                        ...e,
                        date: new Date(e.date)
                    }));
                }
            }

            exportData() {
                const dataStr = JSON.stringify(this.entries, null, 2);
                const blob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `carbon-tracker-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
            }

            importData() {
                document.getElementById('importFile').click();
            }

            handleImport(e) {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const imported = JSON.parse(event.target.result);
                        this.entries = imported.map(e => ({
                            ...e,
                            date: new Date(e.date)
                        }));
                        this.saveData();
                        this.updateDisplay();
                    } catch (err) {
                        alert('Invalid JSON file');
                    }
                };
                reader.readAsText(file);
            }

            shareData() {
                const dataStr = btoa(JSON.stringify(this.entries));
                const url = `${window.location.href.split('#')[0]}#${dataStr}`;
                navigator.clipboard.writeText(url).then(() => {
                    alert('Shareable link copied to clipboard!');
                });
            }

            toggleDarkMode() {
                const isDark = localStorage.getItem('dark-mode') === 'true';
                const newMode = !isDark;
                document.documentElement.setAttribute('data-theme', newMode ? 'dark' : 'light');
                localStorage.setItem('dark-mode', newMode);
                document.getElementById('toggleDark').textContent = newMode ? '‚òÄÔ∏è' : 'üåô';
            }

            showClearConfirm() {
                document.getElementById('confirmDialog').showModal();
            }

            clearAllData() {
                if (confirm('Delete ALL data? This cannot be undone.')) {
                    this.entries = [];
                    localStorage.removeItem('carbon-tracker');
                    document.getElementById('confirmDialog').close();
                    this.updateDisplay();
                }
            }
        }

        // Load from URL hash on page load
        window.addEventListener('DOMContentLoaded', () => {
            const hash = window.location.hash.slice(1);
            if (hash) {
                try {
                    const data = JSON.parse(atob(hash));
                    localStorage.setItem('carbon-tracker', JSON.stringify(data));
                } catch (e) {
                    console.warn('Invalid share data in URL');
                }
            }
            window.tracker = new CarbonTracker();
        });

        // Auto-save on storage change
        window.addEventListener('beforeunload', () => {
            window.tracker?.saveData();
        });
    </script>
</body>
</html>