<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2025-12-21T12:36:38.800493Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research Note Vault</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --text-primary: #1a1a1a;
            --text-secondary: #6c757d;
            --accent: #28a745;
            --accent-hover: #218838;
            --border: #e9ecef;
            --shadow: 0 2px 4px rgba(0,0,0,0.1);
            --shadow-hover: 0 4px 8px rgba(0,0,0,0.15);
            --radius: 8px;
            --transition: all 0.2s ease;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #1a1a1a;
                --bg-secondary: #2d2d2d;
                --text-primary: #ffffff;
                --text-secondary: #adb5bd;
                --border: #404040;
            }
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: var(--transition);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        @media (min-width: 768px) {
            .container {
                grid-template-columns: 250px 1fr;
                gap: 2rem;
            }
        }

        header {
            grid-column: 1 / -1;
            text-align: center;
            padding: 2rem 0;
            border-bottom: 1px solid var(--border);
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--accent), #20c997);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            align-items: center;
            margin-top: 1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius);
            background: var(--accent);
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-hover);
        }

        .btn-secondary {
            background: var(--text-secondary);
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .input-group {
            position: relative;
            flex: 1;
            min-width: 200px;
        }

        input, textarea, select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 1rem;
            transition: var(--transition);
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
        }

        .search-container {
            grid-column: 1 / -1;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .stats-panel {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            transition: var(--transition);
        }

        .stats-panel h3 {
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding: 0.25rem 0;
        }

        .note-form {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
        }

        .note-form h2 {
            margin-bottom: 1rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 150px;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .notes-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .note-card {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .note-card:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-2px);
        }

        .note-header {
            padding: 1.25rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
        }

        .note-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            flex: 1;
        }

        .note-meta {
            font-size: 0.875rem;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .note-preview {
            padding: 0 1.25rem 1.25rem;
            color: var(--text-secondary);
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        .note-card.expanded .note-preview {
            max-height: 200px;
            padding: 1.25rem;
        }

        .note-actions {
            display: flex;
            gap: 0.5rem;
            padding: 0 1.25rem 1.25rem;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .note-card.expanded .note-actions {
            opacity: 1;
        }

        .tag {
            display: inline-block;
            background: var(--accent);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .tag-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .tag-cloud .tag {
            cursor: pointer;
            transition: var(--transition);
        }

        .tag-cloud .tag:hover {
            transform: scale(1.05);
        }

        .hidden {
            display: none;
        }

        @media print {
            .controls, .stats-panel, .btn, .note-actions {
                display: none !important;
            }
            
            .container {
                grid-template-columns: 1fr !important;
            }
            
            .note-card.expanded .note-preview {
                max-height: none !important;
                padding: 1rem 0 !important;
            }
            
            .note-card {
                break-inside: avoid;
                margin-bottom: 1rem;
            }
        }

        .mode-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: none;
            border: 1px solid var(--border);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .mode-toggle:hover {
            background: var(--bg-secondary);
        }
    </style>
</head>
<body>
    <button class="mode-toggle" id="modeToggle" aria-label="Toggle dark mode">üåô</button>
    
    <div class="container">
        <header>
            <h1>Research Note Vault</h1>
            <div class="controls">
                <button class="btn" id="newNoteBtn">‚ûï New Note</button>
                <button class="btn btn-secondary" id="printBtn">üñ®Ô∏è Print</button>
                <button class="btn btn-secondary" id="undoBtn" disabled>‚Ü∂ Undo</button>
                <button class="btn btn-secondary" id="redoBtn" disabled>‚Ü∑ Redo</button>
                <div class="input-group">
                    <input type="text" id="searchInput" placeholder="üîç Search notes..." aria-label="Search notes">
                </div>
            </div>
        </header>

        <aside class="stats-panel" id="statsPanel">
            <h3>üìä Stats</h3>
            <div class="stat"><span>Total Notes:</span><span id="totalNotes">0</span></div>
            <div class="stat"><span>Words Today:</span><span id="wordsToday">0</span></div>
            <div class="stat"><span>Longest Note:</span><span id="longestNote">0</span></div>
            <div class="stat"><span>Popular Tags:</span></div>
            <div id="popularTags"></div>
            <div class="tag-cloud" id="tagCloud"></div>
        </aside>

        <main>
            <div class="search-container">
                <select id="filterSelect" aria-label="Filter notes">
                    <option value="all">All Notes</option>
                    <option value="recent">Recent (7 days)</option>
                    <option value="tagged">Tagged Only</option>
                </select>
            </div>

            <form class="note-form hidden" id="noteForm">
                <h2 id="formTitle">New Note</h2>
                <div class="form-row">
                    <input type="text" id="noteTitle" maxlength="100" placeholder="Note title" required>
                    <input type="text" id="noteTags" placeholder="Tags (comma separated)">
                </div>
                <textarea id="noteContent" maxlength="5000" placeholder="Your research notes..." rows="8" required></textarea>
                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
                    <button type="submit" class="btn">Save Note</button>
                </div>
            </form>

            <div class="notes-list" id="notesList" role="list" aria-label="Notes list"></div>
        </main>
    </div>

    <script>
        class ResearchNoteVault {
            constructor() {
                this.notes = [];
                this.filteredNotes = [];
                this.currentEditId = null;
                this.undoStack = [];
                this.redoStack = [];
                this.nextId = Date.now().toString();
                this.init();
            }

            init() {
                this.loadNotes();
                this.bindEvents();
                this.render();
                this.updateStats();
                this.checkStorage();
                this.updateTheme();
            }

            generateId() {
                return (Date.now() + Math.random()).toString(36);
            }

            loadNotes() {
                try {
                    const data = localStorage.getItem('research-notes-v1');
                    if (data) {
                        this.notes = JSON.parse(data).sort((a, b) => new Date(b.updated) - new Date(a.created));
                        this.nextId = this.notes.length ? Math.max(...this.notes.map(n => parseInt(n.id))) + 1 : Date.now().toString();
                    }
                } catch (e) {
                    console.warn('Failed to load notes:', e);
                    this.notes = [];
                }
                this.filteredNotes = [...this.notes];
            }

            saveNotes() {
                try {
                    localStorage.setItem('research-notes-v1', JSON.stringify(this.notes));
                } catch (e) {
                    alert('Storage quota exceeded. Please delete some notes.');
                }
            }

            executeCommand(command) {
                if (this.undoStack.length > 50) this.undoStack.shift();
                this.undoStack.push(command);
                this.redoStack = [];
                command.execute();
                this.render();
                this.updateStats();
                this.announce(command.message);
            }

            undo() {
                const command = this.undoStack.pop();
                if (command) {
                    this.redoStack.push(command);
                    command.undo();
                    this.render();
                    this.updateStats();
                    this.announce('Undo completed');
                }
            }

            redo() {
                const command = this.redoStack.pop();
                if (command) {
                    this.undoStack.push(command);
                    command.execute();
                    this.render();
                    this.updateStats();
                    this.announce('Redo completed');
                }
            }

            addNote(title, content, tags) {
                const note = {
                    id: this.generateId(),
                    title,
                    content,
                    tags: tags.split(',').map(t => t.trim()).filter(t => t),
                    created: new Date().toISOString(),
                    updated: new Date().toISOString(),
                    wordCount: content.trim().split(/\s+/).length
                };

                const command = {
                    type: 'add',
                    note,
                    message: 'Note added',
                    execute: () => {
                        this.notes.unshift(note);
                        this.filteredNotes.unshift(note);
                    },
                    undo: () => {
                        this.notes = this.notes.filter(n => n.id !== note.id);
                        this.filteredNotes = this.filteredNotes.filter(n => n.id !== note.id);
                    }
                };

                this.executeCommand(command);
                this.saveNotes();
            }

            updateNote(id, title, content, tags) {
                const oldNote = this.notes.find(n => n.id === id);
                if (!oldNote) return;

                const newNote = { ...oldNote, title, content, tags: tags.split(',').map(t => t.trim()).filter(t => t), updated: new Date().toISOString(), wordCount: content.trim().split(/\s+/).length };

                const command = {
                    type: 'update',
                    id,
                    oldNote,
                    newNote,
                    message: 'Note updated',
                    execute: () => {
                        const noteIndex = this.notes.findIndex(n => n.id === id);
                        this.notes[noteIndex] = newNote;
                        const filteredIndex = this.filteredNotes.findIndex(n => n.id === id);
                        if (filteredIndex !== -1) this.filteredNotes[filteredIndex] = newNote;
                    },
                    undo: () => {
                        const noteIndex = this.notes.findIndex(n => n.id === id);
                        this.notes[noteIndex] = oldNote;
                        const filteredIndex = this.filteredNotes.findIndex(n => n.id === id);
                        if (filteredIndex !== -1) this.filteredNotes[filteredIndex] = oldNote;
                    }
                };

                this.executeCommand(command);
                this.saveNotes();
            }

            deleteNote(id) {
                const note = this.notes.find(n => n.id === id);
                if (!note) return;

                const command = {
                    type: 'delete',
                    id,
                    note,
                    message: 'Note deleted',
                    execute: () => {
                        this.notes = this.notes.filter(n => n.id !== id);
                        this.filteredNotes = this.filteredNotes.filter(n => n.id !== id);
                    },
                    undo: () => {
                        this.notes.unshift(note);
                        this.filteredNotes.unshift(note);
                    }
                };

                this.executeCommand(command);
                this.saveNotes();
            }

            search(query) {
                if (!query.trim()) {
                    this.filteredNotes = [...this.notes];
                    return;
                }

                const q = query.toLowerCase();
                this.filteredNotes = this.notes.filter(note =>
                    note.title.toLowerCase().includes(q) ||
                    note.content.toLowerCase().includes(q) ||
                    note.tags.some(tag => tag.toLowerCase().includes(q))
                );
                this.render();
            }

            filterNotes(filter) {
                let filtered = [...this.notes];

                switch (filter) {
                    case 'recent':
                        const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString();
                        filtered = filtered.filter(note => note.updated > weekAgo);
                        break;
                    case 'tagged':
                        filtered = filtered.filter(note => note.tags.length > 0);
                        break;
                }

                this.filteredNotes = filtered;
                this.render();
            }

            render() {
                const container = document.getElementById('notesList');
                container.innerHTML = this.filteredNotes.map(note => `
                    <article class="note-card ${this.currentEditId === note.id ? 'expanded' : ''}" tabindex="0" role="button" aria-expanded="${this.currentEditId === note.id}">
                        <div class="note-header" onclick="vault.toggleNote('${note.id}')" onkeydown="vault.onNoteKeydown(event, '${note.id}')">
                            <div>
                                <div class="note-title">${this.escapeHtml(note.title)}</div>
                                <div style="margin: 0.5rem 0;">
                                    ${note.tags.map(tag => `<span class="tag">${this.escapeHtml(tag)}</span>`).join('')}
                                </div>
                                <div class="note-meta">
                                    üìù ${note.wordCount} words ‚Ä¢ 
                                    üïí ${new Date(note.updated).toLocaleString()} 
                                    ${note.created !== note.updated ? `‚Ä¢ üìÖ Created ${new Date(note.created).toLocaleDateString()}` : ''}
                                </div>
                            </div>
                            <div>‚ñº</div>
                        </div>
                        <div class="note-preview">
                            <p>${this.escapeHtml(note.content.slice(0, 100))}${note.content.length > 100 ? '...' : ''}</p>
                        </div>
                        <div class="note-actions">
                            <button class="btn" onclick="vault.editNote('${note.id}')" aria-label="Edit note">‚úèÔ∏è Edit</button>
                            <button class="btn btn-secondary" onclick="vault.deleteNote('${note.id}')" aria-label="Delete note">üóëÔ∏è Delete</button>
                        </div>
                    </article>
                `).join('');
            }

            toggleNote(id) {
                this.currentEditId = this.currentEditId === id ? null : id;
                this.render();
            }

            onNoteKeydown(event, id) {
                if (event.key === 'Enter' && !event.shiftKey) {
                    event.preventDefault();
                    this.toggleNote(id);
                }
            }

            editNote(id) {
                const note = this.notes.find(n => n.id === id);
                if (!note) return;

                this.currentEditId = id;
                document.getElementById('formTitle').textContent = 'Edit Note';
                document.getElementById('noteTitle').value = note.title;
                document.getElementById('noteContent').value = note.content;
                document.getElementById('noteTags').value = note.tags.join(', ');
                document.getElementById('noteForm').classList.remove('hidden');
                document.getElementById('noteTitle').focus();
                this.render();
            }

            updateStats() {
                const totalNotes = this.notes.length;
                const today = new Date().toDateString();
                const wordsToday = this.notes
                    .filter(note => new Date(note.updated).toDateString() === today)
                    .reduce((sum, note) => sum + note.wordCount, 0);
                const longestNote = Math.max(...this.notes.map(n => n.wordCount), 0);

                const tagCounts = this.notes.reduce((acc, note) => {
                    note.tags.forEach(tag => acc[tag] = (acc[tag] || 0) + 1);
                    return acc;
                }, {});

                const popularTags = Object.entries(tagCounts)
                    .sort(([,a], [,b]) => b - a)
                    .slice(0, 5)
                    .map(([tag]) => tag);

                document.getElementById('totalNotes').textContent = totalNotes;
                document.getElementById('wordsToday').textContent = wordsToday;
                document.getElementById('longestNote').textContent = longestNote;

                document.getElementById('popularTags').innerHTML = popularTags.map(tag => 
                    `<span class="tag" onclick="vault.filterByTag('${tag}')" role="button" tabindex="0">${tag}</span>`
                ).join('');

                this.renderTagCloud(tagCounts);
            }

            renderTagCloud(tagCounts) {
                const container = document.getElementById('tagCloud');
                container.innerHTML = Object.entries(tagCounts)
                    .sort(([,a], [,b]) => b - a)
                    .slice(0, 10)
                    .map(([tag, count]) => 
                        `<span class="tag" onclick="vault.filterByTag('${tag}')" role="button" tabindex="0" style="font-size: ${0.75 + count/20}rem;">${tag} (${count})</span>`
                    ).join('');
            }

            filterByTag(tag) {
                this.searchInput.value = tag;
                this.search(tag);
            }

            checkStorage() {
                if ('storage' in navigator && 'estimate' in navigator.storage) {
                    navigator.storage.estimate().then(estimate => {
                        if (estimate.usage / estimate.quota > 0.8) {
                            if (confirm('Storage is 80% full. Clear notes?')) {
                                localStorage.clear();
                                location.reload();
                            }
                        }
                    });
                }
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            announce(message) {
                const announcement = document.createElement('div');
                announcement.setAttribute('aria-live', 'polite');
                announcement.setAttribute('aria-atomic', 'true');
                announcement.style.position = 'absolute';
                announcement.style.left = '-9999px';
                announcement.textContent = message;
                document.body.appendChild(announcement);
                setTimeout(() => document.body.removeChild(announcement), 1000);
            }

            updateTheme() {
                const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                document.body.classList.toggle('dark', isDark);
            }

            bindEvents() {
                // Form handling
                const form = document.getElementById('noteForm');
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const title = document.getElementById('noteTitle').value.trim();
                    const content = document.getElementById('noteContent').value.trim();
                    const tags = document.getElementById('noteTags').value.trim();

                    if (this.currentEditId) {
                        this.updateNote(this.currentEditId, title, content, tags);
                    } else {
                        this.addNote(title, content, tags);
                    }

                    form.reset();
                    form.classList.add('hidden');
                    this.currentEditId = null;
                });

                document.getElementById('cancelBtn').onclick = () => {
                    form.reset();
                    form.classList.add('hidden');
                    this.currentEditId = null;
                };

                // Controls
                document.getElementById('newNoteBtn').onclick = () => {
                    form.reset();
                    document.getElementById('formTitle').textContent = 'New Note';
                    this.currentEditId = null;
                    form.classList.remove('hidden');
                    document.getElementById('noteTitle').focus();
                };

                document.getElementById('printBtn').onclick = () => window.print();

                document.getElementById('undoBtn').onclick = () => this.undo();
                document.getElementById('redoBtn').onclick = () => this.redo();

                // Search and filter
                document.getElementById('searchInput').oninput = (e) => this.search(e.target.value);
                document.getElementById('filterSelect').onchange = (e) => this.filterNotes(e.target.value);

                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey || e.metaKey) {
                        switch(e.key) {
                            case 'n': e.preventDefault(); document.getElementById('newNoteBtn').click(); break;
                            case 's': e.preventDefault(); break; // Auto-save
                            case 'p': e.preventDefault(); document.getElementById('printBtn').click(); break;
                            case 'f': e.preventDefault(); document.getElementById('searchInput').focus(); break;
                            case 'z':
                                e.preventDefault();
                                if (e.shiftKey) this.redo();
                                else this.undo();
                                break;
                            case 'Escape':
                                document.getElementById('searchInput').value = '';
                                document.getElementById('filterSelect').value = 'all';
                                this.search('');
                                break;
                        }
                    }
                });

                // Theme toggle
                document.getElementById('modeToggle').onclick = () => {
                    document.body.classList.toggle('dark');
                };

                // Theme updates
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                    document.body.classList.toggle('dark', e.matches);
                });

                // Update undo/redo buttons
                const updateButtons = () => {
                    document.getElementById('undoBtn').disabled = this.undoStack.length === 0;
                    document.getElementById('redoBtn').disabled = this.redoStack.length === 0;
                };

                // Override executeCommand to update buttons
                const originalExecute = this.executeCommand;
                this.executeCommand = (command) => {
                    originalExecute.call(this, command);
                    updateButtons();
                };
                updateButtons();
            }
        }

        // Global vault instance
        const vault = new ResearchNoteVault();
    </script>
</body>
</html>