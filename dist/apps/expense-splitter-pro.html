<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2025-12-27T01:26:18.503302Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Splitter Pro</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --text-primary: #1a1a1a;
            --text-secondary: #6c757d;
            --accent: #007bff;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --border: #dee2e6;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #1a1a1a;
                --bg-secondary: #2d2d2d;
                --text-primary: #ffffff;
                --text-secondary: #adb5bd;
                --border: #495057;
            }
        }
        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #adb5bd;
            --border: #495057;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 1rem;
            min-height: 100vh;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border); }
        .theme-toggle { background: none; border: 1px solid var(--border); color: var(--text-primary); padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-size: 1rem; min-height: 44px; }
        .dashboard { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem; }
        @media (max-width: 768px) { .dashboard { grid-template-columns: 1fr; } }
        .summary-card, .pie-chart { background: var(--bg-secondary); padding: 1.5rem; border-radius: 12px; box-shadow: var(--shadow); }
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 1rem; }
        .stat { text-align: center; }
        .stat-value { font-size: 2rem; font-weight: bold; margin-bottom: 0.25rem; }
        .balance.positive { color: var(--success); }
        .balance.negative { color: var(--danger); }
        canvas { max-width: 100%; height: 200px; }
        .form-section { background: var(--bg-secondary); padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem; box-shadow: var(--shadow); }
        .form-grid { display: grid; gap: 1rem; }
        @media (max-width: 768px) { .form-grid { grid-template-columns: 1fr; } }
        .form-grid.cols-2 { grid-template-columns: 1fr 1fr; }
        @media (max-width: 768px) { .form-grid.cols-2 { grid-template-columns: 1fr; } }
        input, select, button { padding: 0.75rem; border: 1px solid var(--border); border-radius: 6px; font-size: 1rem; min-height: 44px; }
        input:focus, select:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(0,123,255,0.1); }
        button { background: var(--accent); color: white; border: none; cursor: pointer; font-weight: 500; transition: background 0.2s; }
        button:hover { background: #0056b3; }
        button.secondary { background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border); }
        .split-section { display: none; background: var(--bg-primary); padding: 1rem; border: 1px solid var(--border); border-radius: 6px; margin-top: 1rem; }
        .split-section.active { display: block; }
        .split-row { display: grid; grid-template-columns: 2fr 1fr 48px; gap: 0.5rem; margin-bottom: 0.5rem; align-items: center; }
        @media (max-width: 768px) { .split-row { grid-template-columns: 2fr 1fr auto; } }
        .category-table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        .category-table th, .category-table td { padding: 1rem; text-align: left; border-bottom: 1px solid var(--border); }
        .category-table th { background: var(--bg-primary); font-weight: 600; }
        .progress-bar { height: 8px; background: var(--bg-primary); border-radius: 4px; overflow: hidden; margin-top: 0.25rem; }
        .progress-fill { height: 100%; transition: width 0.3s; border-radius: 4px; }
        .progress-good { background: var(--success); }
        .progress-warning { background: var(--warning); }
        .progress-danger { background: var(--danger); }
        .transactions-table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        .transactions-table th, .transactions-table td { padding: 0.75rem; text-align: left; border-bottom: 1px solid var(--border); }
        .transactions-table th { background: var(--bg-primary); }
        .income { color: var(--success); font-weight: 500; }
        .expense { color: var(--danger); font-weight: 500; }
        .controls { display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem; }
        .btn-group { display: flex; gap: 0.5rem; }
        .btn-sm { padding: 0.5rem 1rem; font-size: 0.875rem; min-height: 40px; }
        .monthly-selector { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
        .error { color: var(--danger); font-size: 0.875rem; margin-top: 0.25rem; display: none; }
        .print-only { display: none; }
        @media print {
            body * { color: black !important; background: white !important; box-shadow: none !important; }
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            .dashboard, .form-section { break-inside: avoid; }
        }
        .hidden { display: none; }
        dialog { border: none; border-radius: 12px; box-shadow: var(--shadow); padding: 0; max-width: 500px; width: 90vw; }
        dialog::backdrop { background: rgba(0,0,0,0.5); }
    </style>
</head>
<body>
    <div class="container">
        <header class="no-print">
            <h1>Expense Splitter Pro</h1>
            <div>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">üåô</button>
                <div class="btn-group">
                    <button class="btn-sm secondary" onclick="exportData('json')">üì• JSON</button>
                    <input type="file" id="importFile" accept=".json" style="display:none;" onchange="importData(event)">
                    <button class="btn-sm secondary" onclick="document.getElementById('importFile').click()">üì§ Import</button>
                    <button class="btn-sm secondary" onclick="exportCSV()">üìä CSV</button>
                    <button class="btn-sm secondary" onclick="window.print()" aria-label="Print">üñ®Ô∏è Print</button>
                </div>
            </div>
        </header>

        <div class="monthly-selector no-print">
            <button onclick="changeMonth(-1)">‚Äπ Prev</button>
            <select id="monthSelector" onchange="filterMonth()"></select>
            <button onclick="changeMonth(1)">Next ‚Ä∫</button>
        </div>

        <div class="dashboard no-print">
            <div class="summary-card">
                <h2>Monthly Summary</h2>
                <div class="summary-grid">
                    <div class="stat">
                        <div class="stat-value" id="totalIncome">$0</div>
                        <div>Total Income</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="totalExpenses">$0</div>
                        <div>Total Expenses</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value balance" id="balance">$0</div>
                        <div>Balance</div>
                    </div>
                </div>
            </div>
            <div class="pie-chart">
                <h2>50/30/20 Rule</h2>
                <canvas id="pieChart" width="300" height="200"></canvas>
                <div id="pieLegend"></div>
            </div>
        </div>

        <div class="form-section no-print">
            <h2>Add Transaction</h2>
            <form id="transactionForm" onsubmit="addTransaction(event)">
                <div class="form-grid cols-2">
                    <div>
                        <label>Description <span class="error" id="descError">Required</span></label>
                        <input type="text" id="description" required placeholder="e.g., Grocery shopping">
                    </div>
                    <div>
                        <label>Amount <span class="error" id="amountError">Must be number</span></label>
                        <input type="number" id="amount" step="0.01" min="0" required placeholder="0.00">
                    </div>
                    <div>
                        <label>Category</label>
                        <select id="category">
                            <option>Food</option>
                            <option>Rent</option>
                            <option>Salary</option>
                            <option>Entertainment</option>
                            <option>Utilities</option>
                            <option>Savings</option>
                            <option>Custom</option>
                        </select>
                    </div>
                    <div>
                        <label>Date</label>
                        <input type="date" id="date">
                    </div>
                    <div>
                        <label>Split</label>
                        <select id="splitCount" onchange="toggleSplit()">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                        </select>
                    </div>
                </div>
                <div class="split-section" id="splitSection">
                    <h3>Split Details (Total must match original amount)</h3>
                    <div id="splitRows"></div>
                    <div class="error" id="splitError">Split total doesn't match original amount</div>
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                    <button type="submit">Add Transaction</button>
                    <button type="button" class="secondary" onclick="resetForm()">Cancel</button>
                </div>
            </form>
        </div>

        <div class="form-section no-print">
            <h2>Category Budgets</h2>
            <div class="controls">
                <button onclick="resetBudgets()">Reset Defaults</button>
            </div>
            <table class="category-table">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Budget</th>
                        <th>Spent</th>
                        <th>Progress</th>
                    </tr>
                </thead>
                <tbody id="budgetTable"></tbody>
            </table>
        </div>

        <div class="form-section no-print">
            <h2>Transactions</h2>
            <table class="transactions-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Description</th>
                        <th>Category</th>
                        <th>Amount</th>
                        <th>Split</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="transactionsTable"></tbody>
            </table>
        </div>

        <div class="print-only">
            <h1>Expense Summary - <span id="printMonth"></span></h1>
            <div id="printSummary"></div>
            <h2>Transactions</h2>
            <table class="transactions-table">
                <thead>
                    <tr><th>Date</th><th>Description</th><th>Category</th><th>Amount</th></tr>
                </thead>
                <tbody id="printTransactions"></tbody>
            </table>
        </div>
    </div>

    <script>
        let transactions = [];
        let budgets = {};
        let currentMonth = new Date().toISOString().slice(0, 7); // YYYY-MM

        const categories = ['Food', 'Rent', 'Salary', 'Entertainment', 'Utilities', 'Savings'];
        const defaultBudgets = {
            Food: 400, Rent: 1200, Utilities: 200, Entertainment: 300, Savings: 0,
            Salary: 0, Custom: 0
        };

        // Theme handling
        const themeToggle = document.getElementById('themeToggle');
        const setTheme = (theme) => {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            themeToggle.textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        };
        const initTheme = () => {
            const saved = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            setTheme(saved || (prefersDark ? 'dark' : 'light'));
        };
        themeToggle.addEventListener('click', () => {
            const current = document.documentElement.getAttribute('data-theme') || 'light';
            setTheme(current === 'dark' ? 'light' : 'dark');
        });
        window.matchMedia('(prefers-color-scheme: dark)').addListener(initTheme);

        // Data persistence
        const loadData = () => {
            const data = localStorage.getItem('expenseData');
            if (data) {
                const parsed = JSON.parse(data);
                transactions = parsed.transactions || [];
                budgets = { ...defaultBudgets, ...parsed.budgets };
            } else {
                budgets = { ...defaultBudgets };
            }
            populateMonthSelector();
            filterMonth();
        };

        const saveData = () => {
            localStorage.setItem('expenseData', JSON.stringify({ transactions, budgets }));
        };

        const autoSave = () => {
            saveData();
            setTimeout(autoSave, 30000);
        };

        // Month handling
        const populateMonthSelector = () => {
            const select = document.getElementById('monthSelector');
            select.innerHTML = '';
            const year = parseInt(currentMonth.slice(0,4));
            const month = parseInt(currentMonth.slice(5,7));
            for (let m = 0; m < 24; m++) {
                const date = new Date(year, month - 1 + m - 12, 1);
                const ym = date.toISOString().slice(0,7);
                const option = document.createElement('option');
                option.value = ym;
                option.textContent = date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
                if (ym === currentMonth) option.selected = true;
                select.appendChild(option);
            }
        };

        const changeMonth = (dir) => {
            const [year, month] = currentMonth.split('-').map(Number);
            const date = new Date(year, month - 1 + dir, 1);
            currentMonth = date.toISOString().slice(0,7);
            populateMonthSelector();
            filterMonth();
        };

        const filterMonth = () => {
            renderAll();
            document.getElementById('date').value = currentMonth + '-' + new Date(currentMonth + '-01').getDate().toString().padStart(2,'0');
        };

        // Form handling
        const resetForm = () => {
            document.getElementById('transactionForm').reset();
            document.getElementById('date').value = new Date().toISOString().slice(0,10);
            toggleSplit();
            document.querySelectorAll('.error').forEach(e => e.style.display = 'none');
        };

        const toggleSplit = () => {
            const count = parseInt(document.getElementById('splitCount').value);
            const section = document.getElementById('splitSection');
            const rows = document.getElementById('splitRows');
            if (count === 1) {
                section.classList.remove('active');
                return;
            }
            section.classList.add('active');
            rows.innerHTML = '';
            for (let i = 0; i < count; i++) {
                const row = document.createElement('div');
                row.className = 'split-row';
                row.innerHTML = `
                    <input type="text" placeholder="Person ${i+1}" class="split-name">
                    <input type="number" step="0.01" min="0" placeholder="0.00" class="split-amount" oninput="updateSplitTotal()">
                    <button type="button" class="btn-sm secondary" onclick="this.parentElement.remove(); updateSplitCount()">√ó</button>
                `;
                rows.appendChild(row);
            }
            updateSplitTotal();
        };

        const updateSplitCount = () => {
            const rows = document.querySelectorAll('#splitRows .split-row');
            document.getElementById('splitCount').value = rows.length;
            updateSplitTotal();
        };

        const updateSplitTotal = () => {
            const amount = parseFloat(document.getElementById('amount').value) || 0;
            const rows = document.querySelectorAll('.split-amount');
            const total = Array.from(rows).reduce((sum, input) => sum + (parseFloat(input.value) || 0), 0);
            const error = document.getElementById('splitError');
            error.style.display = Math.abs(total - amount) > 0.01 ? 'block' : 'none';
        };

        const validateForm = () => {
            let valid = true;
            document.querySelectorAll('.error').forEach(e => e.style.display = 'none');
            
            const desc = document.getElementById('description').value.trim();
            const monthTransactions = transactions.filter(t => t.date.startsWith(currentMonth));
            if (monthTransactions.some(t => t.description === desc)) {
                document.getElementById('descError').textContent = 'Duplicate description this month';
                document.getElementById('descError').style.display = 'inline';
                valid = false;
            }
            
            const amount = parseFloat(document.getElementById('amount').value);
            if (isNaN(amount) || amount <= 0) {
                document.getElementById('amountError').style.display = 'inline';
                valid = false;
            }
            
            const splitCount = parseInt(document.getElementById('splitCount').value);
            if (splitCount > 1) {
                const totalSplit = Array.from(document.querySelectorAll('.split-amount')).reduce((sum, input) => 
                    sum + (parseFloat(input.value) || 0), 0);
                if (Math.abs(totalSplit - amount) > 0.01) {
                    document.getElementById('splitError').style.display = 'block';
                    valid = false;
                }
            }
            
            return valid;
        };

        const addTransaction = (e) => {
            e.preventDefault();
            if (!validateForm()) return;
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            data.date = document.getElementById('date').value;
            data.amount = parseFloat(data.amount);
            data.splits = [];
            
            const splitCount = parseInt(data.splitCount);
            if (splitCount > 1) {
                const names = document.querySelectorAll('.split-name');
                const amounts = document.querySelectorAll('.split-amount');
                for (let i = 0; i < splitCount; i++) {
                    data.splits.push({
                        name: names[i].value || `Person ${i+1}`,
                        amount: parseFloat(amounts[i].value)
                    });
                }
            }
            
            transactions.unshift(data);
            renderAll();
            resetForm();
        };

        // Rendering
        const getMonthData = () => {
            const monthData = transactions.filter(t => t.date.startsWith(currentMonth));
            const income = monthData.filter(t => ['Salary', 'Savings'].includes(t.category)).reduce((sum, t) => sum + t.amount, 0);
            const expenses = monthData.filter(t => !['Salary', 'Savings'].includes(t.category)).reduce((sum, t) => sum + t.amount, 0);
            const balance = income - expenses;
            
            const needs = monthData.filter(t => ['Food', 'Rent', 'Utilities'].includes(t.category)).reduce((sum, t) => sum + t.amount, 0);
            const wants = monthData.filter(t => t.category === 'Entertainment').reduce((sum, t) => sum + t.amount, 0);
            const savings = monthData.filter(t => t.category === 'Savings').reduce((sum, t) => sum + t.amount, 0);
            
            return { monthData, income, expenses, balance, needs, wants, savings };
        };

        const renderSummary = ({ income, expenses, balance }) => {
            document.getElementById('totalIncome').textContent = `$${income.toFixed(0)}`;
            document.getElementById('totalExpenses').textContent = `$${expenses.toFixed(0)}`;
            const balanceEl = document.getElementById('balance');
            balanceEl.textContent = `$${balance.toFixed(0)}`;
            balanceEl.className = `stat-value balance ${balance >= 0 ? 'positive' : 'negative'}`;
        };

        const renderPieChart = ({ income, needs, wants, savings }) => {
            const canvas = document.getElementById('pieChart');
            const ctx = canvas.getContext('2d');
            const legend = document.getElementById('pieLegend');
            
            if (income === 0) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                legend.innerHTML = '';
                return;
            }
            
            const total = income;
            const data = [
                { value: needs, color: '#28a745', label: 'Needs (50%)', target: total * 0.5 },
                { value: wants, color: '#ffc107', label: 'Wants (30%)', target: total * 0.3 },
                { value: savings, color: '#007bff', label: 'Savings (20%)', target: total * 0.2 }
            ];
            
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 80;
            
            let startAngle = 0;
            data.forEach(({ value, color }, i) => {
                const sliceAngle = (value / total) * 2 * Math.PI;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, startAngle + sliceAngle);
                ctx.closePath();
                ctx.fillStyle = color;
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
                startAngle += sliceAngle;
            });
            
            legend.innerHTML = data.map(({ label, value, target }) => 
                `<div style="display:flex;align-items:center;gap:0.5rem;margin:0.25rem 0;">
                    <div style="width:16px;height:16px;border-radius:50%;background:${data.find(d=>label.includes(d.label.split(' ')[0])).color}"></div>
                    ${label}: $${value.toFixed(0)} / $${target.toFixed(0)}
                </div>`).join('');
        };

        const renderBudgetTable = (monthData) => {
            const tbody = document.getElementById('budgetTable');
            tbody.innerHTML = '';
            categories.forEach(cat => {
                const spent = monthData.filter(t => t.category === cat).reduce((sum, t) => sum + t.amount, 0);
                const budget = budgets[cat] || 0;
                const percent = budget ? (spent / budget) * 100 : 0;
                let progressClass = 'progress-good';
                if (percent > 100) progressClass = 'progress-danger';
                else if (percent > 80) progressClass = 'progress-warning';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${cat}</td>
                    <td>$${budget.toLocaleString()}</td>
                    <td>$${spent.toFixed(0)}</td>
                    <td>
                        <div>${percent.toFixed(0)}%</div>
                        <div class="progress-bar">
                            <div class="progress-fill ${progressClass}" style="width: ${Math.min(percent, 100)}%"></div>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        };

        const renderTransactionsTable = (monthData) => {
            const tbody = document.getElementById('transactionsTable');
            tbody.innerHTML = '';
            monthData.forEach((t, i) => {
                const row = document.createElement('tr');
                const amountClass = t.amount > 0 ? 'income' : 'expense';
                const splitText = t.splits?.length ? `${t.splits.length} people` : '';
                row.innerHTML = `
                    <td>${new Date(t.date).toLocaleDateString()}</td>
                    <td>${t.description}</td>
                    <td>${t.category}</td>
                    <td class="${amountClass}">$${t.amount.toFixed(2)}</td>
                    <td>${splitText}</td>
                    <td><button class="btn-sm secondary" onclick="deleteTransaction(${transactions.indexOf(t)})">Delete</button></td>
                `;
                tbody.appendChild(row);
            });
        };

        const renderAll = () => {
            const { monthData, income, expenses, balance, needs, wants, savings } = getMonthData();
            renderSummary({ income, expenses, balance });
            renderPieChart({ income, needs, wants, savings });
            renderBudgetTable(monthData);
            renderTransactionsTable(monthData);
            renderPrintView({ monthData, income, expenses, balance });
        };

        const renderPrintView = ({ monthData, income, expenses, balance }) => {
            document.getElementById('printMonth').textContent = new Date(currentMonth + '-01').toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
            document.getElementById('printSummary').innerHTML = `
                <p><strong>Total Income:</strong> $${income.toFixed(0)}</p>
                <p><strong>Total Expenses:</strong> $${expenses.toFixed(0)}</p>
                <p><strong>Balance:</strong> $${balance.toFixed(0)}</p>
            `;
            const tbody = document.getElementById('printTransactions');
            tbody.innerHTML = monthData.map(t => 
                `<tr>
                    <td>${new Date(t.date).toLocaleDateString()}</td>
                    <td>${t.description}</td>
                    <td>${t.category}</td>
                    <td>$${t.amount.toFixed(2)}</td>
                </tr>`
            ).join('');
        };

        const deleteTransaction = (index) => {
            if (confirm('Delete this transaction?')) {
                transactions.splice(index, 1);
                renderAll();
            }
        };

        const resetBudgets = () => {
            budgets = { ...defaultBudgets };
            renderAll();
        };

        // Export/Import
        const exportData = (format) => {
            if (format === 'csv') return exportCSV();
            const dataStr = JSON.stringify({ transactions, budgets, currentMonth }, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `expenses-${currentMonth}.json`;
            a.click();
        };

        const exportCSV = () => {
            const monthData = transactions.filter(t => t.date.startsWith(currentMonth) && t.amount < 0);
            const csv = ['Date,Description,Category,Amount',
                ...monthData.map(t => `${t.date},${t.description},${t.category},${t.amount}`)
            ].join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `expenses-${currentMonth}.csv`;
            a.click();
        };

        const importData = (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (ev) => {
                try {
                    const data = JSON.parse(ev.target.result);
                    transactions = data.transactions || [];
                    budgets = { ...defaultBudgets, ...data.budgets };
                    currentMonth = data.currentMonth || currentMonth;
                    populateMonthSelector();
                    renderAll();
                } catch (err) {
                    alert('Invalid JSON file');
                }
            };
            reader.readAsText(file);
        };

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && e.target.tagName === 'BUTTON') {
                e.target.click();
            }
            if (e.key === 'Escape') {
                resetForm();
            }
        });

        // Init
        document.getElementById('date').value = new Date().toISOString().slice(0,10);
        initTheme();
        loadData();
        renderAll();
        autoSave();
    </script>
</body>
</html>