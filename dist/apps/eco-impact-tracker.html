<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2025-12-18T04:34:21.086187Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Eco Impact Tracker</title>
<style>
:root{
  --bg-grad: linear-gradient(135deg,#e6f9f0 0%,#d9f0ff 100%);
  --card:#ffffff;
  --text:#0b2f2f;
  --accent:#2aa876;
  --muted:#4b6666;
  --progress-bg:#e6efe9;
  --glass: rgba(255,255,255,0.6);
}
:root[data-theme="dark"]{
  --bg-grad: linear-gradient(135deg,#07120a 0%,#001018 100%);
  --card: rgba(6,22,15,0.6);
  --text:#dff7ec;
  --accent:#58d48f;
  --muted:#9fbfb3;
  --progress-bg:#052015;
  --glass: rgba(0,0,0,0.5);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:Inter,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  background:var(--bg-grad);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  padding:16px;
  display:flex;
  align-items:start;
  justify-content:center;
  gap:16px;
  min-height:100vh;
}
/* Container */
.container{
  width:100%;
  max-width:980px;
  background:linear-gradient(180deg,rgba(255,255,255,0.55),rgba(255,255,255,0.35));
  border-radius:12px;
  padding:18px;
  box-shadow:0 8px 30px rgba(2,12,8,0.12);
  backdrop-filter: blur(6px);
  border:1px solid rgba(255,255,255,0.4);
}
[data-theme="dark"] .container{
  background: linear-gradient(180deg, rgba(6,16,12,0.45), rgba(3,12,10,0.35));
  border:1px solid rgba(255,255,255,0.04);
  box-shadow:0 8px 40px rgba(0,0,0,0.6);
}

/* Header */
.header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
}
.brand{
  display:flex;
  gap:12px;
  align-items:center;
}
.earth{
  font-size:28px;
  filter:drop-shadow(0 2px 6px rgba(0,0,0,0.15));
}
.title{
  font-weight:700;
  letter-spacing:-0.2px;
  font-size:18px;
}
.subtitle{font-size:12px;color:var(--muted)}

/* Grid */
.grid{
  display:grid;
  grid-template-columns:1fr;
  gap:14px;
  margin-top:14px;
}
@media(min-width:720px){
  .grid{grid-template-columns:1fr 320px;}
}

/* Card */
.card{
  background:var(--card);
  border-radius:10px;
  padding:12px;
  box-shadow:inset 0 0 0 1px rgba(0,0,0,0.03);
}
[data-theme="dark"] .card{background:linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.18));}

/* Controls list */
.controls{display:grid;gap:10px}
.control{
  display:flex;
  align-items:center;
  gap:10px;
}
.control label{
  width:120px;
  font-size:13px;
}
.slider-wrap{flex:1;display:flex;align-items:center;gap:8px}
input[type="range"]{
  width:100%;
  accent-color:var(--accent);
  -webkit-appearance:none;
  height:6px;
  background:linear-gradient(90deg,var(--accent),#3aa0ff);
  border-radius:6px;
}
input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:18px;height:18px;border-radius:50%;
  background:var(--card);box-shadow:0 2px 6px rgba(0,0,0,0.25);
  border:2px solid var(--accent);
}
.value-bubble{
  min-width:56px;
  text-align:right;
  font-variant-numeric:tabular-nums;
  font-size:13px;
  color:var(--muted);
}

/* Score panel */
.score-panel{
  display:flex;
  flex-direction:column;
  gap:12px;
  align-items:stretch;
}
.score-big{
  font-size:28px;
  font-weight:700;
  display:flex;
  align-items:baseline;
  gap:8px;
}
.score-kg{font-size:14px;color:var(--muted)}
.animated{
  transition:transform 300ms cubic-bezier(.2,.9,.3,1), opacity 260ms;
}
.progress{
  height:16px;
  background:var(--progress-bg);
  border-radius:10px;
  overflow:hidden;
  position:relative;
}
.progress-bar{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,var(--accent),#3aa0ff);
  transition:width 500ms ease, background 300ms;
}

/* Legend */
.legend{display:flex;gap:8px;flex-wrap:wrap;font-size:12px;color:var(--muted)}
.legend .dot{width:10px;height:10px;border-radius:50%;display:inline-block}

/* Buttons */
.row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.btn{
  background:transparent;
  border:1px solid rgba(0,0,0,0.08);
  padding:8px 10px;border-radius:8px;
  font-size:13px;
  cursor:pointer;
  color:var(--text);
}
[data-theme="dark"] .btn{border:1px solid rgba(255,255,255,0.06);}
.btn.primary{background:linear-gradient(90deg,var(--accent),#3aa0ff);color:#002218;border:0}
.icon{font-size:14px;margin-right:6px}

/* Small controls */
.small{font-size:13px;color:var(--muted);display:flex;gap:8px;align-items:center}
.toggle{
  display:inline-flex;align-items:center;gap:8px;padding:6px;border-radius:999px;border:1px solid rgba(0,0,0,0.06);
  background:var(--glass);
}
[data-theme="dark"] .toggle{border:1px solid rgba(255,255,255,0.04)}

/* Summary table (also print) */
.summary{
  width:100%;
  border-collapse:collapse;
  margin-top:6px;
}
.summary th, .summary td{padding:8px 6px;text-align:left;border-bottom:1px dashed rgba(0,0,0,0.06);font-size:13px}
[data-theme="dark"] .summary th, [data-theme="dark"] .summary td{border-bottom-color:rgba(255,255,255,0.03)}
.summary th{font-weight:600;color:var(--muted);font-size:12px}

/* Print styles */
@media print{
  body{background:white;color:black}
  .container{box-shadow:none;border:none;background:white}
  .header, .controls, .row, .small, .btn, .toggle, #shareUrl, #hashCopy, #resetBtn{display:none !important}
  .card{background:white;box-shadow:none;border:0}
  .summary th, .summary td{color:black}
}

/* Accessibility focus */
:focus{outline:3px solid rgba(82,184,129,0.18);outline-offset:2px;border-radius:6px}

/* Responsive tweaks */
@media(max-width:420px){
  .title{font-size:15px}
  .label-small{display:none}
}
</style>
</head>
<body>
<div class="container" role="application" aria-label="Eco Impact Tracker" id="app">
  <div class="header">
    <div class="brand">
      <div class="earth" aria-hidden="true">üåç</div>
      <div>
        <div class="title">Eco Impact Tracker</div>
        <div class="subtitle">Estimate daily carbon (kg CO‚ÇÇe) ‚Äî sliders update live</div>
      </div>
    </div>
    <div class="row" style="align-items:center">
      <div class="small toggle" role="group" aria-label="Theme">
        <label for="themeToggle" class="label-small">Theme</label>
        <input id="themeToggle" type="checkbox" aria-label="Toggle dark theme" />
      </div>
      <button class="btn" id="printBtn" aria-label="Print summary">Print</button>
      <button class="btn" id="shareBtn" aria-label="Copy share URL">Share</button>
      <button class="btn" id="resetBtn" aria-label="Reset values">Reset</button>
    </div>
  </div>

  <div class="grid" id="mainGrid">
    <div class="card" aria-labelledby="controlsHeading">
      <h2 id="controlsHeading" style="font-size:15px;margin:0 0 10px 0">Daily Activities</h2>
      <div class="controls" role="region" aria-live="polite" aria-describedby="controlsHeading">
        <!-- Driving -->
        <div class="control">
          <label for="drive">Driving (km)</label>
          <div class="slider-wrap">
            <input id="drive" type="range" min="0" max="500" step="1" value="0" aria-label="Driving kilometers" />
            <div class="value-bubble" id="driveVal">0 km</div>
          </div>
        </div>
        <!-- Flights -->
        <div class="control">
          <label for="flight">Flights (km)</label>
          <div class="slider-wrap">
            <input id="flight" type="range" min="0" max="500" step="1" value="0" aria-label="Flights kilometers" />
            <div class="value-bubble" id="flightVal">0 km</div>
          </div>
        </div>
        <!-- Electricity -->
        <div class="control">
          <label for="energy">Electricity (kWh)</label>
          <div class="slider-wrap">
            <input id="energy" type="range" min="0" max="500" step="1" value="0" aria-label="Electricity kilowatt hours" />
            <div class="value-bubble" id="energyVal">0 kWh</div>
          </div>
        </div>
        <!-- Meat meals -->
        <div class="control">
          <label for="meat">Meat meals (per day)</label>
          <div class="slider-wrap">
            <input id="meat" type="range" min="0" max="20" step="1" value="0" aria-label="Meat meals per day" />
            <div class="value-bubble" id="meatVal">0 meals</div>
          </div>
        </div>
        <!-- Plastic waste -->
        <div class="control">
          <label for="plastic">Plastic items (per week)</label>
          <div class="slider-wrap">
            <input id="plastic" type="range" min="0" max="500" step="1" value="0" aria-label="Plastic items per week" />
            <div class="value-bubble" id="plasticVal">0 /wk</div>
          </div>
        </div>

        <div class="small" style="justify-content:space-between;margin-top:6px">
          <div>Sliders: use arrow keys to adjust; Enter/Space to focus controls.</div>
          <div style="font-size:12px;color:var(--muted)">Range: 0‚Äì500 (plastic weekly capped at 500)</div>
        </div>
      </div>
    </div>

    <aside class="card score-panel" aria-labelledby="scoreHeading">
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div id="scoreHeading" style="font-size:13px;color:var(--muted)">Daily Carbon Score</div>
            <div class="score-big animated" id="scoreAnim"><span id="scoreValue">0.0</span><span class="score-kg">kg CO‚ÇÇe/day</span></div>
          </div>
          <div style="text-align:right">
            <div style="font-size:12px;color:var(--muted)">Weekly total</div>
            <div style="font-weight:700;font-size:16px" id="weeklyValue">0.0 kg</div>
          </div>
        </div>

        <div style="margin-top:10px">
          <div class="progress" aria-hidden="true">
            <div class="progress-bar" id="progressBar" style="width:0%"></div>
          </div>
          <div class="legend" style="margin-top:8px">
            <div><span class="dot" style="background:linear-gradient(90deg,#66d89a,#3aa0ff)"></span> <span style="margin-left:6px">Score</span></div>
            <div><strong style="margin-left:6px" id="rangeLabel">Low</strong></div>
          </div>
        </div>
      </div>

      <div>
        <h3 style="font-size:13px;margin:8px 0 6px 0;color:var(--muted)">Breakdown</h3>
        <table class="summary" aria-label="Emission breakdown">
          <thead><tr><th>Activity</th><th style="text-align:right">Daily kg CO‚ÇÇe</th></tr></thead>
          <tbody>
            <tr><td>Driving</td><td style="text-align:right" id="bDrive">0.0</td></tr>
            <tr><td>Flights</td><td style="text-align:right" id="bFlight">0.0</td></tr>
            <tr><td>Electricity</td><td style="text-align:right" id="bEnergy">0.0</td></tr>
            <tr><td>Meat meals</td><td style="text-align:right" id="bMeat">0.0</td></tr>
            <tr><td>Plastic (weekly ‚Üí daily)</td><td style="text-align:right" id="bPlastic">0.0</td></tr>
            <tr><th>Total</th><th style="text-align:right" id="bTotal">0.0</th></tr>
          </tbody>
        </table>
      </div>

      <div style="display:flex;gap:8px;justify-content:space-between;align-items:center;margin-top:8px">
        <div style="font-size:12px;color:var(--muted)">Shareable hash updates URL</div>
        <div style="display:flex;gap:8px">
          <button class="btn" id="hashCopy" aria-label="Copy shareable URL">Copy URL</button>
          <button class="btn primary" id="saveBtn" aria-label="Save to localStorage">Save</button>
        </div>
      </div>
    </aside>
  </div>
</div>

<script>
/* Eco Impact Tracker - single file app
   Features implemented per specification:
   - sliders with validation, keyboard accessible
   - multipliers and real-time calc
   - daily + weekly totals, progress bar with color ranges
   - localStorage persistence and save button
   - theme detection and toggle persisted
   - shareable URL via hash encoding and parsing
   - print-friendly via CSS
   - escape closes modals (none implemented) but handled for future
*/

/* Constants */
const MULT = {
  drive: 0.2,    // kg per km
  flight: 0.25,  // kg per km
  energy: 0.5,   // kg per kWh
  meat: 2.0,     // kg per meal
  plastic: 0.1   // kg per item (weekly)
};
const MAX = 500;

/* Elements */
const els = {
  drive: document.getElementById('drive'),
  flight: document.getElementById('flight'),
  energy: document.getElementById('energy'),
  meat: document.getElementById('meat'),
  plastic: document.getElementById('plastic'),
  driveVal: document.getElementById('driveVal'),
  flightVal: document.getElementById('flightVal'),
  energyVal: document.getElementById('energyVal'),
  meatVal: document.getElementById('meatVal'),
  plasticVal: document.getElementById('plasticVal'),
  scoreValue: document.getElementById('scoreValue'),
  weeklyValue: document.getElementById('weeklyValue'),
  progressBar: document.getElementById('progressBar'),
  rangeLabel: document.getElementById('rangeLabel'),
  bDrive: document.getElementById('bDrive'),
  bFlight: document.getElementById('bFlight'),
  bEnergy: document.getElementById('bEnergy'),
  bMeat: document.getElementById('bMeat'),
  bPlastic: document.getElementById('bPlastic'),
  bTotal: document.getElementById('bTotal'),
  themeToggle: document.getElementById('themeToggle'),
  saveBtn: document.getElementById('saveBtn'),
  resetBtn: document.getElementById('resetBtn'),
  shareBtn: document.getElementById('shareBtn'),
  hashCopy: document.getElementById('hashCopy'),
  printBtn: document.getElementById('printBtn'),
  app: document.getElementById('app')
};

/* Util: round safe */
function toNum(v){ v = Number(v); return Number.isFinite(v) ? v : 0; }
function round1(v){ return Math.round(v*10)/10; }

/* Update UI values and calculate */
function updateAll(triggerHashUpdate=true){
  // sanitize & clamp
  const drive = Math.max(0, Math.min(MAX, Math.round(toNum(els.drive.value))));
  const flight = Math.max(0, Math.min(MAX, Math.round(toNum(els.flight.value))));
  const energy = Math.max(0, Math.min(MAX, Math.round(toNum(els.energy.value))));
  const meat = Math.max(0, Math.min(20, Math.round(toNum(els.meat.value))));
  const plastic = Math.max(0, Math.min(MAX, Math.round(toNum(els.plastic.value))));

  els.drive.value = drive;
  els.flight.value = flight;
  els.energy.value = energy;
  els.meat.value = meat;
  els.plastic.value = plastic;

  els.driveVal.textContent = drive + ' km';
  els.flightVal.textContent = flight + ' km';
  els.energyVal.textContent = energy + ' kWh';
  els.meatVal.textContent = meat + ' meals';
  els.plasticVal.textContent = plastic + ' /wk';

  // Daily emissions
  const eDrive = round1(drive * MULT.drive);
  const eFlight = round1(flight * MULT.flight);
  const eEnergy = round1(energy * MULT.energy);
  const eMeat = round1(meat * MULT.meat);
  // plastic provided per week; convert to daily
  const ePlastic = round1((plastic * MULT.plastic) / 7);

  const totalDaily = round1(eDrive + eFlight + eEnergy + eMeat + ePlastic);
  const totalWeekly = round1(totalDaily * 7);

  // Update breakdown
  els.bDrive.textContent = eDrive.toFixed(1);
  els.bFlight.textContent = eFlight.toFixed(1);
  els.bEnergy.textContent = eEnergy.toFixed(1);
  els.bMeat.textContent = eMeat.toFixed(1);
  els.bPlastic.textContent = ePlastic.toFixed(1);
  els.bTotal.textContent = totalDaily.toFixed(1);

  // Animated score
  animateNumber(els.scoreValue, totalDaily, 500);
  els.weeklyValue.textContent = totalWeekly.toFixed(1) + ' kg';

  // Progress: map 0-100kg to 0-100% (cap at 200 for visual)
  const pct = Math.min(100, Math.round((totalDaily/100)*100));
  els.progressBar.style.width = pct + '%';

  // Color ranges: green <20, yellow 20-50, red >50
  if(totalDaily < 20){
    els.progressBar.style.background = 'linear-gradient(90deg,#7ee6a6,#3aa0ff)';
    els.rangeLabel.textContent = 'Low (<20 kg/day)';
  } else if(totalDaily <= 50){
    els.progressBar.style.background = 'linear-gradient(90deg,#f7d26b,#ff9a5a)';
    els.rangeLabel.textContent = 'Medium (20‚Äì50 kg/day)';
  } else {
    els.progressBar.style.background = 'linear-gradient(90deg,#ff6b6b,#c92a2a)';
    els.rangeLabel.textContent = 'High (>50 kg/day)';
  }

  // Persist draft automatically
  saveDraftLocal();

  // Update URL hash
  if(triggerHashUpdate) updateHash({drive,flight,energy,meat,plastic});
}

/* Animate numeric change */
let animTimer;
function animateNumber(el, target, ms){
  cancelAnimationFrame(animTimer);
  const start = parseFloat(el.textContent) || 0;
  const diff = target - start;
  const startTime = performance.now();
  function step(now){
    const t = Math.min(1, (now - startTime)/ms);
    const eased = t<0.5 ? 2*t*t : -1 + (4-2*t)*t;
    el.textContent = (start + diff*eased).toFixed(1);
    if(t < 1) animTimer = requestAnimationFrame(step);
  }
  animTimer = requestAnimationFrame(step);
}

/* Persistence */
const LS_KEY = 'ecoimpact:v1';
const THEME_KEY = 'ecoimpact:theme';
function saveDraftLocal(){
  const state = {
    drive: Number(els.drive.value),
    flight: Number(els.flight.value),
    energy: Number(els.energy.value),
    meat: Number(els.meat.value),
    plastic: Number(els.plastic.value)
  };
  try{ localStorage.setItem(LS_KEY, JSON.stringify(state)); }catch(e){ /* ignore */ }
}
function loadDraftLocal(){
  try{
    const raw = localStorage.getItem(LS_KEY);
    if(!raw) return false;
    const s = JSON.parse(raw);
    if(s && typeof s === 'object'){
      setValuesFromObject(s, false);
      return true;
    }
  }catch(e){}
  return false;
}
function clearDraft(){
  try{ localStorage.removeItem(LS_KEY); }catch(e){}
}

/* Theme handling */
function applyTheme(pref){
  document.documentElement.setAttribute('data-theme', pref === 'dark' ? 'dark' : 'light');
  document.documentElement.setAttribute('data-user-theme', pref);
  els.themeToggle.checked = (pref === 'dark');
  try{ localStorage.setItem(THEME_KEY, pref); }catch(e){}
}
function initTheme(){
  const saved = localStorage.getItem(THEME_KEY);
  if(saved){ applyTheme(saved); return; }
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  applyTheme(prefersDark ? 'dark' : 'light');
}

/* Hash encoding & parsing */
function updateHash(state){
  const parts = [
    'drive:'+state.drive,
    'flight:'+state.flight,
    'energy:'+state.energy,
    'meat:'+state.meat,
    'plastic:'+state.plastic
  ];
  const hash = '#'+parts.join('|');
  if(location.hash !== hash){
    history.replaceState(null,'',hash);
  }
}
function parseHashAndLoad(){
  if(!location.hash) return false;
  try{
    const raw = decodeURIComponent(location.hash.slice(1));
    const parts = raw.split('|');
    const obj = {};
    parts.forEach(p=>{
      const [k,v] = p.split(':');
      if(k && v!=null) obj[k.trim()] = Math.round(Number(v));
    });
    // map keys to our inputs (support both energy and electricity synonyms)
    const mapped = {
      drive: obj.drive,
      flight: obj.flight,
      energy: obj.energy || obj.energy_kwh || obj.electricity,
      meat: obj.meat,
      plastic: obj.plastic
    };
    // if at least one value parsed, set
    const any = Object.values(mapped).some(v=>typeof v === 'number' && !isNaN(v));
    if(any){ setValuesFromObject(mapped, false); return true; }
  }catch(e){}
  return false;
}

/* Set values from object and update UI */
function setValuesFromObject(o, updateHashNow=true){
  if(typeof o.drive === 'number') els.drive.value = clampVal(o.drive);
  if(typeof o.flight === 'number') els.flight.value = clampVal(o.flight);
  if(typeof o.energy === 'number') els.energy.value = clampVal(o.energy);
  if(typeof o.meat === 'number') els.meat.value = clampVal(o.meat);
  if(typeof o.plastic === 'number') els.plastic.value = clampVal(o.plastic);
  updateAll(updateHashNow);
}
function clampVal(v){ return Math.max(0, Math.min(MAX, Math.round(Number(v) || 0))); }

/* Copy share URL */
function copyShareURL(){
  try{
    const url = location.origin + location.pathname + location.hash;
    navigator.clipboard.writeText(url).then(()=> {
      flashMessage('Share URL copied');
    }, ()=> {
      prompt('Copy this URL', url);
    });
  }catch(e){
    prompt('Share URL', location.href);
  }
}

/* Flash message (simple) */
function flashMessage(txt){
  const span = document.createElement('span');
  span.textContent = txt;
  span.style.position='fixed';
  span.style.left='50%';
  span.style.transform='translateX(-50%)';
  span.style.bottom='24px';
  span.style.background='rgba(0,0,0,0.8)';
  span.style.color='white';
  span.style.padding='8px 12px';
  span.style.borderRadius='8px';
  span.style.zIndex=9999;
  document.body.appendChild(span);
  setTimeout(()=>{ span.style.transition='opacity 300ms'; span.style.opacity='0'; }, 1200);
  setTimeout(()=>{ document.body.removeChild(span); }, 1600);
}

/* Reset */
function doReset(){
  els.drive.value = 0;
  els.flight.value = 0;
  els.energy.value = 0;
  els.meat.value = 0;
  els.plastic.value = 0;
  updateAll();
  clearDraft();
  // clear hash
  history.replaceState(null,'',location.pathname);
}

/* Keyboard accessibility: sliders already keyboard accessible.
   Add arrow key step control for fine tuning and Escape to blur focused element.
*/
document.addEventListener('keydown', (e)=>{
  const el = document.activeElement;
  if(e.key === 'Escape'){
    if(el && (el.tagName === 'INPUT' || el.tagName === 'BUTTON')) el.blur();
  }
  // allow +/- shortcuts when a slider is focused or body
  if(['ArrowLeft','ArrowRight','ArrowUp','ArrowDown'].includes(e.key)){
    if(el && el.type === 'range'){
      e.preventDefault();
      const step = Number(el.step) || 1;
      if(e.key === 'ArrowLeft' || e.key === 'ArrowDown') el.value = Number(el.value) - step;
      if(e.key === 'ArrowRight' || e.key === 'ArrowUp') el.value = Number(el.value) + step;
      updateAll();
    }
  }
});

/* Bind events */
['drive','flight','energy','meat','plastic'].forEach(id=>{
  const input = els[id];
  const valEl = els[id+'Val'];
  // input events
  input.addEventListener('input', ()=> updateAll());
  // keyboard Enter/Space focus handled default; ensure label click focuses
  input.addEventListener('change', ()=> updateAll());
  // make sure we clamp on blur
  input.addEventListener('blur', ()=> { input.value = clampVal(input.value); updateAll(); });
});

/* Buttons */
els.saveBtn.addEventListener('click', ()=>{
  saveDraftLocal();
  flashMessage('Saved locally');
});
els.resetBtn.addEventListener('click', ()=>{
  if(confirm('Reset all values and clear saved data?')) doReset();
});
els.shareBtn.addEventListener('click', copyShareURL);
els.hashCopy.addEventListener('click', copyShareURL);
els.printBtn.addEventListener('click', ()=> window.print());

/* Theme toggle */
els.themeToggle.addEventListener('change', ()=>{
  applyTheme(els.themeToggle.checked ? 'dark' : 'light');
});

/* Load sequence: parse hash first, then localStorage fallback, then defaults.
   If both present, hash takes precedence.
*/
function init(){
  initTheme();
  const hashLoaded = parseHashAndLoad();
  if(!hashLoaded){
    const loaded = loadDraftLocal();
    if(!loaded){
      updateAll(false);
      // ensure hash reflects defaults
      updateHash({drive:0,flight:0,energy:0,meat:0,plastic:0});
    }
  }
  // If hash present, ensure persisted to localStorage too
  saveDraftLocal();
}

/* When URL hash changes (e.g., pasted), parse and load */
window.addEventListener('hashchange', ()=> parseHashAndLoad());

/* Initialize */
init();

/* Testing convenience: ensure example given in prompt works.
   If user loads with #drive:100|energy:10 the app will prefill via hash parser.
*/

/* Ensure no NaN: guard before unload */
window.addEventListener('beforeunload', ()=> saveDraftLocal());
</script>
</body>
</html>