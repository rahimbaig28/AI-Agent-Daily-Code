<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2025-11-21T13:25:53.503856Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Study Stack</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 1rem;
      background-color: #f5f5f5;
      color: #333;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    .stack-controls {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .stack-controls select, .stack-controls button, .stack-controls input {
      padding: 0.5rem;
      font-size: 1rem;
    }
    .card {
      background: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      min-height: 150px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      position: relative;
    }
    .card.flipped .front, .card .back {
      display: none;
    }
    .card.flipped .back {
      display: block;
    }
    .card .front, .card .back {
      width: 100%;
      text-align: center;
      font-size: 1.2rem;
    }
    .card-actions {
      position: absolute;
      bottom: 0.5rem;
      right: 0.5rem;
      display: flex;
      gap: 0.5rem;
    }
    .card-actions button {
      padding: 0.25rem 0.5rem;
      font-size: 0.8rem;
    }
    .card-list {
      margin-top: 1rem;
    }
    .card-item {
      display: flex;
      justify-content: space-between;
      padding: 0.5rem;
      border-bottom: 1px solid #eee;
    }
    .card-item button {
      padding: 0.25rem 0.5rem;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 1rem;
      border-radius: 8px;
      width: 90%;
      max-width: 500px;
    }
    .modal input, .modal textarea {
      width: 100%;
      padding: 0.5rem;
      margin-bottom: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
    }
    .modal-actions button {
      padding: 0.5rem 1rem;
    }
    .help {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #666;
    }
    @media (max-width: 600px) {
      .header {
        flex-direction: column;
        align-items: stretch;
        gap: 0.5rem;
      }
      .stack-controls {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Study Stack</h1>
    <div class="header">
      <div class="stack-controls">
        <select id="stack-select" aria-label="Select stack"></select>
        <button id="new-stack" aria-label="Create new stack">New Stack</button>
        <button id="rename-stack" aria-label="Rename current stack">Rename</button>
        <button id="delete-stack" aria-label="Delete current stack">Delete</button>
      </div>
      <div class="stack-controls">
        <button id="undo" aria-label="Undo last action">Undo (Ctrl+Z)</button>
        <button id="redo" aria-label="Redo last action">Redo (Ctrl+Y)</button>
      </div>
    </div>
    <div id="card-container" class="card" tabindex="0" aria-label="Flashcard">
      <div class="front">Click to flip</div>
      <div class="back">Answer</div>
      <div class="card-actions">
        <button id="edit-card" aria-label="Edit card">Edit</button>
        <button id="delete-card" aria-label="Delete card">Delete</button>
      </div>
    </div>
    <div class="card-list" id="card-list"></div>
    <div class="help">
      <p>Keyboard shortcuts: Arrow keys to flip, Enter to add, Delete to remove, Ctrl+Z/Y for undo/redo.</p>
      <p>Share stack: Copy URL to share current stack.</p>
    </div>
  </div>

  <div id="modal" class="modal" role="dialog" aria-labelledby="modal-title">
    <div class="modal-content">
      <h2 id="modal-title">Add Card</h2>
      <input type="text" id="card-question" placeholder="Question" aria-label="Question"/>
      <textarea id="card-answer" placeholder="Answer" aria-label="Answer"></textarea>
      <div class="modal-actions">
        <button id="modal-cancel">Cancel</button>
        <button id="modal-save">Save</button>
      </div>
    </div>
  </div>

  <script>
    // State
    let stacks = JSON.parse(localStorage.getItem('study-stacks') || '{}');
    let currentStackId = localStorage.getItem('current-stack-id') || '';
    let undoStack = [];
    let redoStack = [];

    // DOM Elements
    const stackSelect = document.getElementById('stack-select');
    const newStackBtn = document.getElementById('new-stack');
    const renameStackBtn = document.getElementById('rename-stack');
    const deleteStackBtn = document.getElementById('delete-stack');
    const undoBtn = document.getElementById('undo');
    const redoBtn = document.getElementById('redo');
    const cardContainer = document.getElementById('card-container');
    const cardList = document.getElementById('card-list');
    const editCardBtn = document.getElementById('edit-card');
    const deleteCardBtn = document.getElementById('delete-card');
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modal-title');
    const cardQuestion = document.getElementById('card-question');
    const cardAnswer = document.getElementById('card-answer');
    const modalCancel = document.getElementById('modal-cancel');
    const modalSave = document.getElementById('modal-save');

    // Helpers
    function saveState() {
      localStorage.setItem('study-stacks', JSON.stringify(stacks));
      localStorage.setItem('current-stack-id', currentStackId);
      updateUrl();
    }

    function updateUrl() {
      if (currentStackId) {
        history.replaceState(null, '', `#${currentStackId}`);
      } else {
        history.replaceState(null, '', location.pathname);
      }
    }

    function loadFromUrl() {
      const hash = location.hash.slice(1);
      if (hash && stacks[hash]) {
        currentStackId = hash;
        localStorage.setItem('current-stack-id', currentStackId);
      }
    }

    function pushUndo(action, data) {
      undoStack.push({ action, data });
      redoStack = [];
      updateUndoRedoButtons();
    }

    function updateUndoRedoButtons() {
      undoBtn.disabled = undoStack.length === 0;
      redoBtn.disabled = redoStack.length === 0;
    }

    function undo() {
      if (undoStack.length === 0) return;
      const action = undoStack.pop();
      redoStack.push(action);
      // Reverse action
      if (action.action === 'add') {
        const stack = stacks[currentStackId];
        stack.cards = stack.cards.filter(c => c.id !== action.data.id);
      } else if (action.action === 'delete') {
        const stack = stacks[currentStackId];
        stack.cards.push(action.data);
      } else if (action.action === 'edit') {
        const stack = stacks[currentStackId];
        const card = stack.cards.find(c => c.id === action.data.id);
        if (card) {
          Object.assign(card, action.data.old);
        }
      }
      saveState();
      render();
      updateUndoRedoButtons();
    }

    function redo() {
      if (redoStack.length === 0) return;
      const action = redoStack.pop();
      undoStack.push(action);
      // Re-apply action
      if (action.action === 'add') {
        const stack = stacks[currentStackId];
        stack.cards.push(action.data);
      } else if (action.action === 'delete') {
        const stack = stacks[currentStackId];
        stack.cards = stack.cards.filter(c => c.id !== action.data.id);
      } else if (action.action === 'edit') {
        const stack = stacks[currentStackId];
        const card = stack.cards.find(c => c.id === action.data.id);
        if (card) {
          Object.assign(card, action.data.new);
        }
      }
      saveState();
      render();
      updateUndoRedoButtons();
    }

    function newStack() {
      const name = prompt('Stack name:');
      if (!name) return;
      const id = Date.now().toString();
      stacks[id] = { name, cards: [] };
      currentStackId = id;
      pushUndo('create-stack', { id, name });
      saveState();
      render();
    }

    function renameStack() {
      if (!currentStackId) return;
      const stack = stacks[currentStackId];
      const name = prompt('New name:', stack.name);
      if (!name) return;
      pushUndo('rename-stack', { id: currentStackId, old: stack.name });
      stack.name = name;
      saveState();
      render();
    }

    function deleteStack() {
      if (!currentStackId || !confirm('Delete stack?')) return;
      const stack = stacks[currentStackId];
      pushUndo('delete-stack', { id: currentStackId, stack });
      delete stacks[currentStackId];
      currentStackId = Object.keys(stacks) || '';
      saveState();
      render();
    }

    function addCard(question = '', answer = '') {
      if (!currentStackId) return;
      const stack = stacks[currentStackId];
      const id = Date.now().toString();
      const card = { id, question, answer };
      stack.cards.push(card);
      pushUndo('add', card);
      saveState();
      render();
      return card;
    }

    function editCard(id, question, answer) {
      if (!currentStackId) return;
      const stack = stacks[currentStackId];
      const card = stack.cards.find(c => c.id === id);
      if (!card) return;
      const old = { ...card };
      card.question = question;
      card.answer = answer;
      pushUndo('edit', { id, old, new: { question, answer } });
      saveState();
      render();
    }

    function deleteCard(id) {
      if (!currentStackId) return;
      const stack = stacks[currentStackId];
      const card = stack.cards.find(c => c.id === id);
      if (!card) return;
      stack.cards = stack.cards.filter(c => c.id !== id);
      pushUndo('delete', card);
      saveState();
      render();
    }

    function render() {
      // Update stack select
      stackSelect.innerHTML = '';
      Object.entries(stacks).forEach(([id, stack]) => {
        const option = document.createElement('option');
        option.value = id;
        option.textContent = stack.name;
        if (id === currentStackId) option.selected = true;
        stackSelect.appendChild(option);
      });

      // Update current stack display
      if (currentStackId && stacks[currentStackId]) {
        const stack = stacks[currentStackId];
        const card = stack.cards || { question: 'Click to add a card', answer: '' };
        cardContainer.querySelector('.front').textContent = card.question;
        cardContainer.querySelector('.back').textContent = card.answer;
        cardContainer.dataset.cardId = card.id || '';
        cardContainer.classList.remove('flipped');
        // Render card list
        cardList.innerHTML = '';
        stack.cards.forEach(card => {
          const item = document.createElement('div');
          item.className = 'card-item';
          item.innerHTML = `
            <span>${card.question}</span>
            <div>
              <button data-id="${card.id}" class="edit-btn" aria-label="Edit">Edit</button>
              <button data-id="${card.id}" class="delete-btn" aria-label="Delete">Delete</button>
            </div>
          `;
          cardList.appendChild(item);
        });
      } else {
        cardContainer.querySelector('.front').textContent = 'No stack selected';
        cardContainer.querySelector('.back').textContent = '';
        cardContainer.dataset.cardId = '';
        cardContainer.classList.remove('flipped');
        cardList.innerHTML = '';
      }

      // Update buttons
      renameStackBtn.disabled = !currentStackId;
      deleteStackBtn.disabled = !currentStackId;
      editCardBtn.disabled = !currentStackId || !cardContainer.dataset.cardId;
      deleteCardBtn.disabled = !currentStackId || !cardContainer.dataset.cardId;
    }

    // Event Listeners
    newStackBtn.addEventListener('click', newStack);
    renameStackBtn.addEventListener('click', renameStack);
    deleteStackBtn.addEventListener('click', deleteStack);
    undoBtn.addEventListener('click', undo);
    redoBtn.addEventListener('click', redo);

    cardContainer.addEventListener('click', () => {
      cardContainer.classList.toggle('flipped');
    });

    editCardBtn.addEventListener('click', () => {
      const id = cardContainer.dataset.cardId;
      if (!id) return;
      const stack = stacks[currentStackId];
      const card = stack.cards.find(c => c.id === id);
      if (!card) return;
      cardQuestion.value = card.question;
      cardAnswer.value = card.answer;
      modalTitle.textContent = 'Edit Card';
      modal.dataset.mode = 'edit';
      modal.dataset.cardId = id;
      modal.style.display = 'flex';
      cardQuestion.focus();
    });

    deleteCardBtn.addEventListener('click', () => {
      const id = cardContainer.dataset.cardId;
      if (!id) return;
      if (confirm('Delete card?')) {
        deleteCard(id);
      }
    });

    cardList.addEventListener('click', e => {
      if (e.target.classList.contains('edit-btn')) {
        const id = e.target.dataset.id;
        const stack = stacks[currentStackId];
        const card = stack.cards.find(c => c.id === id);
        if (!card) return;
        cardQuestion.value = card.question;
        cardAnswer.value = card.answer;
        modalTitle.textContent = 'Edit Card';
        modal.dataset.mode = 'edit';
        modal.dataset.cardId = id;
        modal.style.display = 'flex';
        cardQuestion.focus();
      } else if (e.target.classList.contains('delete-btn')) {
        const id = e.target.dataset.id;
        if (confirm('Delete card?')) {
          deleteCard(id);
        }
      }
    });

    stackSelect.addEventListener('change', () => {
      currentStackId = stackSelect.value;
      saveState();
      render();
    });

    modalCancel.addEventListener('click', () => {
      modal.style.display = 'none';
    });

    modalSave.addEventListener('click', () => {
      const question = cardQuestion.value.trim();
      const answer = cardAnswer.value.trim();
      if (!question || !answer) {
        alert('Both question and answer are required.');
        return;
      }
      if (modal.dataset.mode === 'edit') {
        editCard(modal.dataset.cardId, question, answer);
      } else {
        addCard(question, answer);
      }
      modal.style.display = 'none';
      cardQuestion.value = '';
      cardAnswer.value = '';
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', e => {
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
      if (e.key === 'Enter') {
        cardQuestion.value = '';
        cardAnswer.value = '';
        modalTitle.textContent = 'Add Card';
        modal.dataset.mode = 'add';
        modal.style.display = 'flex';
        cardQuestion.focus();
        e.preventDefault();
      } else if (e.key === 'Delete') {
        const id = cardContainer.dataset.cardId;
        if (id && confirm('Delete card?')) {
          deleteCard(id);
        }
      } else if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
        cardContainer.classList.toggle('flipped');
        e.preventDefault();
      } else if (e.ctrlKey && e.key === 'z') {
        undo();
        e.preventDefault();
      } else if (e.ctrlKey && e.key === 'y') {
        redo();
        e.preventDefault();
      }
    });

    // Initialize
    loadFromUrl();
    if (!currentStackId && Object.keys(stacks).length > 0) {
      currentStackId = Object.keys(stacks);
    }
    render();
    updateUndoRedoButtons();
  </script>
</body>
</html>