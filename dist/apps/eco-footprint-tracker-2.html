<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2026-01-14T22:38:46.252407Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eco Footprint Tracker</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            background: #2d5016; color: #fff; padding: 20px; line-height: 1.5;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 30px; color: #90ee90; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #90ee90; }
        input[type="number"] { 
            width: 100%; padding: 12px; border: 2px solid #90ee90; border-radius: 8px; 
            background: #3a5a20; color: #fff; font-size: 16px;
        }
        input[type="number"]:focus { outline: none; border-color: #fff; box-shadow: 0 0 10px #90ee90; }
        button { 
            padding: 12px 24px; background: #90ee90; color: #2d5016; border: none; 
            border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; 
            transition: all 0.3s; margin-right: 10px; margin-bottom: 10px;
        }
        button:hover { background: #fff; transform: translateY(-2px); }
        button:focus { outline: 3px solid #90ee90; outline-offset: 2px; }
        .stats { background: rgba(58,90,32,0.8); padding: 25px; border-radius: 12px; margin-bottom: 30px; }
        .stat-item { text-align: center; margin-bottom: 15px; }
        .stat-value { font-size: 2.5em; font-weight: 700; color: #90ee90; }
        #gauge { width: 200px; height: 200px; margin: 20px auto; }
        .days-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }
        .day-card { 
            background: rgba(58,90,32,0.6); padding: 20px; border-radius: 12px; cursor: pointer; 
            transition: all 0.3s; border: 2px solid transparent;
        }
        .day-card:hover, .day-card.selected { border-color: #90ee90; background: rgba(58,90,32,0.9); }
        .day-card button { background: #ff4444; color: #fff; padding: 6px 12px; font-size: 14px; margin-left: 10px; }
        .chart-container { background: rgba(58,90,32,0.8); padding: 25px; border-radius: 12px; height: 350px; }
        canvas { width: 100%; height: 300px; }
        .reset-btn { background: #ff4444; color: #fff; }
        .share-url { 
            background: rgba(144,238,144,0.2); padding: 15px; border-radius: 8px; 
            word-break: break-all; font-family: monospace; margin-top: 10px;
        }
        .hidden { display: none; }
        @media (max-width: 768px) { 
            body { padding: 10px; } 
            .stat-value { font-size: 2em; }
            #gauge { width: 150px; height: 150px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Eco Footprint Tracker</h1>
        
        <div class="stats" role="region" aria-live="polite">
            <div class="stat-item">
                <div class="stat-value" id="weeklyTotal">0</div>
                <div>Weekly Total (kg CO2e)</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="dailyAvg">0</div>
                <div>Daily Average (kg CO2e)</div>
            </div>
            <svg id="gauge" viewBox="0 0 100 100" role="img" aria-label="Daily average progress gauge">
                <circle cx="50" cy="50" r="42" fill="none" stroke="#3a5a20" stroke-width="8"></circle>
                <circle id="gaugeFill" cx="50" cy="50" r="42" fill="none" stroke="#90ee90" stroke-width="8" 
                        stroke-linecap="round" stroke-dasharray="263.89" transform="rotate(-90 50 50)"></circle>
            </svg>
        </div>

        <div class="grid">
            <div>
                <form id="footprintForm" aria-label="Daily footprint input form">
                    <div class="form-group">
                        <label for="carKm">Car (km driven)</label>
                        <input type="number" id="carKm" min="0" max="1000" step="0.1" aria-label="Kilometers driven by car" role="slider" aria-valuemin="0" aria-valuemax="1000" aria-valuenow="0">
                        <span>kg CO2e = km × 0.2</span>
                    </div>
                    <div class="form-group">
                        <label for="kwhUsed">Electricity (kWh used)</label>
                        <input type="number" id="kwhUsed" min="0" max="1000" step="0.1" aria-label="Kilowatt hours used" role="slider" aria-valuemin="0" aria-valuemax="1000" aria-valuenow="0">
                        <span>kg CO2e = kWh × 0.5</span>
                    </div>
                    <div class="form-group">
                        <label for="mealsMeat">Meat meals eaten</label>
                        <input type="number" id="mealsMeat" min="0" max="1000" step="1" aria-label="Number of meat meals" role="slider" aria-valuemin="0" aria-valuemax="1000" aria-valuenow="0">
                        <span>kg CO2e = meals × 2.0</span>
                    </div>
                    <div class="form-group">
                        <label for="mealsVeggie">Veggie meals eaten</label>
                        <input type="number" id="mealsVeggie" min="0" max="1000" step="1" aria-label="Number of veggie meals" role="slider" aria-valuemin="0" aria-valuemax="1000" aria-valuenow="0">
                        <span>kg CO2e = meals × 0.5</span>
                    </div>
                    <button type="submit" id="calculateBtn">Calculate & Add Day</button>
                    <button type="button" id="clearBtn">Clear Form</button>
                </form>
                <div id="shareUrl" class="share-url hidden" role="status"></div>
                <button id="resetBtn" class="reset-btn">Reset All Data</button>
            </div>

            <div>
                <div class="chart-container">
                    <h3 style="margin-bottom: 20px; color: #90ee90;">Weekly Chart (Last 7 Days)</h3>
                    <canvas id="chartCanvas" width="300" height="300" aria-label="Bar chart of daily CO2e emissions for last 7 days"></canvas>
                </div>
            </div>
        </div>

        <div style="margin-top: 40px;">
            <h3 style="color: #90ee90; margin-bottom: 20px;">Recent Days</h3>
            <div id="daysList" class="days-list" role="listbox" aria-label="List of recent footprint entries"></div>
        </div>
    </div>

    <script>
        class EcoTracker {
            constructor() {
                this.days = [];
                this.currentDayIndex = -1;
                this.init();
            }

            init() {
                this.loadData();
                if (this.days.length === 0) this.addSampleData();
                this.render();
                this.bindEvents();
                this.updateHash();
                this.simulateServiceWorker();
            }

            loadData() {
                const hash = window.location.hash.slice(1);
                if (hash) {
                    try {
                        this.days = JSON.parse(atob(hash));
                    } catch (e) {
                        console.warn('Invalid hash data');
                    }
                } else {
                    const stored = localStorage.getItem('ecoDays');
                    if (stored) this.days = JSON.parse(stored);
                }
                this.days.sort((a, b) => new Date(b.date) - new Date(a.date));
                this.currentDayIndex = this.days.length > 0 ? 0 : -1;
            }

            saveData() {
                localStorage.setItem('ecoDays', JSON.stringify(this.days));
                this.updateHash();
            }

            updateHash() {
                const hash = btoa(JSON.stringify(this.days.slice(-50))); // Limit to last 50 days
                window.location.hash = hash;
            }

            addSampleData() {
                const sampleDays = [
                    { date: '2026-01-08', carKm: 20, kwhUsed: 10, mealsMeat: 1, mealsVeggie: 1, total: 9 },
                    { date: '2026-01-09', carKm: 15, kwhUsed: 12, mealsMeat: 2, mealsVeggie: 0, total: 11.5 },
                    { date: '2026-01-10', carKm: 0, kwhUsed: 8, mealsMeat: 0, mealsVeggie: 3, total: 5 },
                    { date: '2026-01-11', carKm: 30, kwhUsed: 15, mealsMeat: 1, mealsVeggie: 1, total: 17 },
                    { date: '2026-01-12', carKm: 10, kwhUsed: 9, mealsMeat: 1, mealsVeggie: 2, total: 8.5 },
                    { date: '2026-01-13', carKm: 25, kwhUsed: 11, mealsMeat: 2, mealsVeggie: 1, total: 14 },
                    { date: '2026-01-14', carKm: 5, kwhUsed: 7, mealsMeat: 0, mealsVeggie: 3, total: 5.5 }
                ];
                this.days.push(...sampleDays);
                this.saveData();
            }

            calculateTotal(carKm, kwhUsed, mealsMeat, mealsVeggie) {
                return (carKm * 0.2) + (kwhUsed * 0.5) + (mealsMeat * 2.0) + (mealsVeggie * 0.5);
            }

            addDay(carKm, kwhUsed, mealsMeat, mealsVeggie) {
                const today = new Date().toISOString().split('T')[0];
                const total = this.calculateTotal(carKm, kwhUsed, mealsMeat, mealsVeggie);
                this.days.unshift({ date: today, carKm, kwhUsed, mealsMeat, mealsVeggie, total });
                this.days = this.days.slice(0, 100); // Keep last 100 days
                this.saveData();
                this.render();
            }

            updateDay(index, data) {
                this.days[index] = { ...this.days[index], ...data };
                this.saveData();
                this.render();
            }

            deleteDay(index) {
                this.days.splice(index, 1);
                this.saveData();
                this.render();
            }

            getLast7Stats() {
                const last7 = this.days.slice(0, 7);
                const total = last7.reduce((sum, day) => sum + day.total, 0);
                const avg = last7.length ? total / last7.length : 0;
                return { total: total.toFixed(1), avg: avg.toFixed(1), days: last7 };
            }

            render() {
                const stats = this.getLast7Stats();
                
                // Update stats
                document.getElementById('weeklyTotal').textContent = stats.total;
                document.getElementById('dailyAvg').textContent = stats.avg;
                
                // Update gauge
                const gaugePercent = Math.min(stats.avg / 10 * 100, 100);
                const circumference = 2 * Math.PI * 42;
                document.getElementById('gaugeFill').style.strokeDasharray = `${circumference * gaugePercent / 100} ${circumference}`;
                
                // Update inputs if editing
                if (this.currentDayIndex >= 0) {
                    const day = this.days[this.currentDayIndex];
                    document.getElementById('carKm').value = day.carKm || 0;
                    document.getElementById('kwhUsed').value = day.kwhUsed || 0;
                    document.getElementById('mealsMeat').value = day.mealsMeat || 0;
                    document.getElementById('mealsVeggie').value = day.mealsVeggie || 0;
                }
                
                this.renderDaysList();
                this.renderChart(stats.days);
            }

            renderDaysList() {
                const container = document.getElementById('daysList');
                const last7 = this.days.slice(0, 7);
                container.innerHTML = last7.map((day, i) => `
                    <div class="day-card ${i === this.currentDayIndex ? 'selected' : ''}" 
                         tabindex="0" role="option" aria-selected="${i === this.currentDayIndex}"
                         data-index="${i}">
                        <div><strong>${day.date}</strong> — ${day.total}kg CO2e</div>
                        <div style="font-size: 0.9em; opacity: 0.8;">
                            Car: ${day.carKm}km, Power: ${day.kwhUsed}kWh, 
                            Meals: ${day.mealsMeat + day.mealsVeggie}
                        </div>
                        <button onclick="tracker.deleteDay(${i})" aria-label="Delete this day">Delete</button>
                    </div>
                `).join('');
            }

            renderChart(days) {
                const canvas = document.getElementById('chartCanvas');
                const ctx = canvas.getContext('2d');
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width;
                canvas.height = 300;

                const maxValue = Math.max(...days.map(d => d.total), 1);
                const barWidth = canvas.width / days.length - 10;
                const barHeightScale = 250 / maxValue;

                // Animate bars
                let frame = 0;
                const animate = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.fillStyle = '#2d5016';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    days.forEach((day, i) => {
                        const barHeight = Math.min((day.total * barHeightScale) * (frame / 30), day.total * barHeightScale);
                        ctx.fillStyle = `hsl(120, 50%, ${50 + (day.total / maxValue) * 30}%)`;
                        ctx.fillRect(i * (barWidth + 10) + 10, canvas.height - barHeight - 20, barWidth, barHeight);
                        
                        // Labels
                        ctx.fillStyle = '#fff';
                        ctx.font = '12px sans-serif';
                        ctx.textAlign = 'center';
                        ctx.fillText(day.total.toFixed(1), i * (barWidth + 10) + barWidth/2 + 10, canvas.height - 5);
                    });
                    
                    frame++;
                    if (frame < 30) requestAnimationFrame(animate);
                };
                animate();
            }

            bindEvents() {
                const form = document.getElementById('footprintForm');
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const formData = new FormData(form);
                    const data = Object.fromEntries(formData);
                    Object.keys(data).forEach(key => {
                        const val = parseFloat(data[key]);
                        data[key] = isNaN(val) ? 0 : Math.max(0, Math.min(1000, val));
                    });
                    
                    if (this.currentDayIndex >= 0) {
                        this.updateDay(this.currentDayIndex, data);
                        this.currentDayIndex = -1;
                    } else {
                        this.addDay(data.carKm, data.kwhUsed, data.mealsMeat, data.mealsVeggie);
                    }
                    form.reset();
                    this.render();
                });

                document.getElementById('clearBtn').addEventListener('click', () => {
                    form.reset();
                    this.currentDayIndex = -1;
                    this.render();
                });

                document.getElementById('resetBtn').addEventListener('click', () => {
                    if (confirm('Clear all data? This cannot be undone.')) {
                        localStorage.removeItem('ecoDays');
                        this.days = [];
                        this.render();
                    }
                });

                // Keyboard navigation
                document.getElementById('daysList').addEventListener('keydown', (e) => {
                    const cards = document.querySelectorAll('.day-card');
                    const current = document.activeElement;
                    const index = Array.from(cards).indexOf(current);
                    
                    if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
                        e.preventDefault();
                        const newIndex = (index + (e.key === 'ArrowDown' ? 1 : -1) + cards.length) % cards.length;
                        cards[newIndex].focus();
                        cards[newIndex].click();
                    } else if (e.key === 'Enter') {
                        current.click();
                    } else if (e.key === 'Escape') {
                        document.getElementById('calculateBtn').focus();
                    }
                });

                // Day card clicks
                document.getElementById('daysList').addEventListener('click', (e) => {
                    const card = e.target.closest('.day-card');
                    if (card) {
                        const index = parseInt(card.dataset.index);
                        this.currentDayIndex = index;
                        this.render();
                        card.focus();
                    }
                });

                // Hash change
                window.addEventListener('hashchange', () => this.init());
            }

            simulateServiceWorker() {
                if ('serviceWorker' in navigator && 'caches' in window) {
                    caches.open('eco-tracker-v1').then(cache => {
                        cache.addAll(['index.html', '/']); // Cache app shell
                    });
                }
            }
        }

        // Global tracker for event handlers
        const tracker = new EcoTracker();

        // Input validation and ARIA updates
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', function() {
                const val = parseFloat(this.value) || 0;
                this.setAttribute('aria-valuenow', val);
                this.value = Math.max(0, Math.min(1000, val));
            });
        });

        // Enter key on inputs submits form
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    document.getElementById('calculateBtn').click();
                }
            });
        });
    </script>
</body>
</html>