<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2026-01-26T17:45:40.048886Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eco Carbon Tracker</title>
  <style>
    :root {
      --green-primary: #228B22;
      --green-light: #90EE90;
      --green-dark: #006400;
      --earth-brown: #8B4513;
      --bg-light: #F0FFF0;
      --bg-dark: #2F4F2F;
      --text-light: #000;
      --text-dark: #FFF;
      --shadow: 0 4px 8px rgba(0,0,0,0.2);
      --border-radius: 12px;
      --transition: all 0.3s ease;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg-light: #2F4F2F;
        --bg-dark: #1a3c1a;
        --text-light: #FFF;
        --text-dark: #000;
      }
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, var(--bg-light), #E0F2E9);
      color: var(--text-light);
      min-height: 100vh;
      padding: 1rem;
      line-height: 1.5;
    }
    .header {
      text-align: center;
      margin-bottom: 2rem;
      padding: 1.5rem;
      background: rgba(255,255,255,0.9);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
    }
    h1 { color: var(--green-primary); font-size: 2rem; margin-bottom: 0.5rem; }
    .weekly-total { font-size: 1.5rem; font-weight: bold; color: var(--green-dark); }
    .goal-progress {
      background: #ddd;
      height: 12px;
      border-radius: 6px;
      margin: 1rem 0;
      overflow: hidden;
    }
    .goal-progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--green-light), var(--green-primary));
      transition: width var(--transition);
    }
    .controls {
      display: flex; gap: 1rem; justify-content: center; margin-bottom: 2rem; flex-wrap: wrap;
    }
    .btn { 
      padding: 0.75rem 1.5rem; 
      border: none; 
      border-radius: var(--border-radius); 
      background: var(--green-primary); 
      color: white; 
      cursor: pointer; 
      transition: var(--transition);
      font-size: 1rem;
    }
    .btn:hover { background: var(--green-dark); transform: translateY(-2px); }
    .btn.active { background: var(--green-dark); }
    .toggle { background: #666; }
    .toggle.active { background: var(--green-primary); }
    .categories {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 1rem; margin-bottom: 2rem;
    }
    .category-tile {
      height: 120px; display: flex; flex-direction: column; align-items: center;
      justify-content: center; background: rgba(255,255,255,0.9);
      border: 3px dashed transparent; border-radius: var(--border-radius);
      cursor: grab; transition: var(--transition); user-select: none;
      box-shadow: var(--shadow);
    }
    .category-tile:hover { transform: scale(1.05); }
    .category-tile.dragging { opacity: 0.5; transform: rotate(5deg); }
    .category-tile.drag-over { border-color: var(--green-primary); background: var(--green-light); }
    .cat-icon { font-size: 3rem; margin-bottom: 0.5rem; }
    .drop-zone {
      min-height: 100px; border: 3px dashed var(--green-primary);
      border-radius: var(--border-radius); display: flex; align-items: center;
      justify-content: center; background: rgba(144,238,144,0.3);
      margin-bottom: 2rem; transition: var(--transition);
    }
    .entries-list { max-height: 400px; overflow-y: auto; }
    .entry {
      display: flex; justify-content: space-between; align-items: center;
      padding: 1rem; margin-bottom: 0.5rem; background: rgba(255,255,255,0.9);
      border-radius: var(--border-radius); box-shadow: var(--shadow);
      animation: slideIn 0.3s ease;
    }
    @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } }
    .entry.co2-high { border-left: 5px solid #FF6B6B; }
    .charts { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0; }
    canvas { background: rgba(255,255,255,0.9); border-radius: var(--border-radius); box-shadow: var(--shadow); }
    .suggestions {
      background: #FFF3CD; border: 1px solid #FFEAA7; border-radius: var(--border-radius);
      padding: 1rem; margin-top: 1rem;
    }
    .suggestion { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
    .modal {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;
    }
    .modal-content {
      background: white; padding: 2rem; border-radius: var(--border-radius);
      box-shadow: var(--shadow); max-width: 400px; width: 90%;
    }
    .form-group { margin-bottom: 1rem; }
    label { display: block; margin-bottom: 0.5rem; font-weight: bold; }
    input, select { width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px; }
    @media (max-width: 768px) {
      .charts { grid-template-columns: 1fr; }
      .controls { flex-direction: column; align-items: center; }
      .categories { grid-template-columns: repeat(2, 1fr); }
      body { padding: 0.5rem; }
    }
    .hidden { display: none !important; }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); }
  </style>
</head>
<body>
  <header class="header" role="banner">
    <h1 aria-label="Eco Carbon Tracker">üåç Eco Carbon Tracker</h1>
    <div class="weekly-total" id="weeklyTotal" aria-live="polite">0 kg CO2</div>
    <div class="goal-progress">
      <div class="goal-progress-fill" id="goalProgress" style="width: 0%"></div>
    </div>
    <div>Weekly Goal: <span id="goalValue">20</span> kg</div>
  </header>

  <nav class="controls" role="navigation">
    <button class="btn toggle active" data-view="daily" aria-pressed="true">Daily</button>
    <button class="btn toggle" data-view="weekly" aria-pressed="false">Weekly</button>
    <button class="btn" id="editGoal">Edit Goal</button>
    <button class="btn" id="exportData">Export</button>
    <label class="btn drop-zone" for="importFile" id="importZone" role="button" tabindex="0">
      Import
      <input type="file" id="importFile" accept=".json" class="sr-only">
    </label>
    <button class="btn" id="undoBtn" disabled>Undo</button>
    <button class="btn" id="redoBtn" disabled>Redo</button>
  </nav>

  <div class="categories" role="grid" aria-label="Activity categories">
    <div class="category-tile" draggable="true" data-category="transport" tabindex="0" role="button" aria-label="Transport">
      <div class="cat-icon">üöó</div>
      <div>Transport</div>
    </div>
    <div class="category-tile" draggable="true" data-category="energy" tabindex="0" role="button" aria-label="Energy">
      <div class="cat-icon">‚ö°</div>
      <div>Energy</div>
    </div>
    <div class="category-tile" draggable="true" data-category="food" tabindex="0" role="button" aria-label="Food">
      <div class="cat-icon">üçΩÔ∏è</div>
      <div>Food</div>
    </div>
    <div class="category-tile" draggable="true" data-category="waste" tabindex="0" role="button" aria-label="Waste">
      <div class="cat-icon">üóëÔ∏è</div>
      <div>Waste</div>
    </div>
  </div>

  <div class="drop-zone" id="dropZone" tabindex="0" aria-label="Drop category here to add entry">
    Drag category here or click to select
  </div>

  <div class="entries-list" id="entriesList" aria-label="Activity entries list"></div>

  <div class="charts">
    <canvas id="barChart" width="400" height="300" aria-label="Weekly CO2 bar chart"></canvas>
    <canvas id="pieChart" width="400" height="300" aria-label="Category breakdown pie chart"></canvas>
  </div>

  <div id="suggestions" class="suggestions hidden"></div>

  <!-- Modals -->
  <div id="entryModal" class="modal" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal-content">
      <h2 id="modalTitle">Add Entry</h2>
      <form id="entryForm">
        <div class="form-group">
          <label for="entryCategory">Category</label>
          <input type="text" id="entryCategory" readonly>
        </div>
        <div class="form-group">
          <label for="entryValue">Value</label>
          <input type="number" id="entryValue" min="0" step="0.1" required>
          <small id="valueHelp"></small>
        </div>
        <div class="form-group">
          <label for="entryDate">Date</label>
          <input type="date" id="entryDate" required>
        </div>
        <div class="form-group">
          <button type="submit" class="btn">Save</button>
          <button type="button" class="btn" id="cancelEntry">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <div id="goalModal" class="modal" role="dialog" aria-hidden="true">
    <div class="modal-content">
      <h2>Edit Weekly Goal</h2>
      <form id="goalForm">
        <div class="form-group">
          <label for="goalInput">Goal (kg CO2/week)</label>
          <input type="number" id="goalInput" min="1" step="0.1" required>
        </div>
        <div class="form-group">
          <button type="submit" class="btn">Save</button>
          <button type="button" class="btn" id="cancelGoal">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    class EcoCarbonTracker {
      constructor() {
        this.entries = [];
        this.settings = { weeklyGoal: 20, factors: {
          transport: 0.2, // kg/km
          energy: 0.5,    // kg/kWh
          food: 5,        // kg/meal
          waste: 0.1      // kg/item
        }};
        this.currentView = 'daily';
        this.history = [];
        this.historyIndex = -1;
        this.init();
      }

      init() {
        this.loadData();
        if (this.entries.length === 0) this.generateSampleData();
        this.bindEvents();
        this.render();
        window.addEventListener('keydown', e => this.handleKeydown(e));
      }

      generateSampleData() {
        const today = new Date();
        today.setHours(0,0,0,0);
        for (let i = 6; i >= 0; i--) {
          const date = new Date(today);
          date.setDate(today.getDate() - i);
          this.entries.push({
            id: Date.now() + i,
            date: date.toISOString().split('T')[0],
            category: ['transport', 'energy', 'food', 'waste'][i % 4],
            value: (1 + i * 0.5).toFixed(1),
            co2: 0
          });
        }
        this.recalcEntries();
        this.saveData();
      }

      bindEvents() {
        // Drag & drop
        document.querySelectorAll('.category-tile').forEach(tile => {
          tile.addEventListener('dragstart', e => this.handleDragStart(e));
          tile.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              this.showEntryModal(tile.dataset.category);
            }
          });
        });

        const dropZone = document.getElementById('dropZone');
        ['dragover', 'dragenter'].forEach(ev => {
          dropZone.addEventListener(ev, e => this.handleDragOver(e));
        });
        dropZone.addEventListener('dragleave', e => this.handleDragLeave(e));
        dropZone.addEventListener('drop', e => this.handleDrop(e));
        dropZone.addEventListener('keydown', e => {
          if (e.key === 'Enter' || e.key === ' ') e.preventDefault();
        });

        // View toggle
        document.querySelectorAll('[data-view]').forEach(btn => {
          btn.addEventListener('click', () => this.toggleView(btn.dataset.view));
        });

        // Forms
        document.getElementById('entryForm').addEventListener('submit', e => this.saveEntry(e));
        document.getElementById('cancelEntry').addEventListener('click', () => this.closeModal('entryModal'));
        document.getElementById('goalForm').addEventListener('submit', e => this.saveGoal(e));
        document.getElementById('cancelGoal').addEventListener('click', () => this.closeModal('goalModal'));

        // Buttons
        document.getElementById('editGoal').addEventListener('click', () => this.showGoalModal());
        document.getElementById('exportData').addEventListener('click', () => this.exportData());
        document.getElementById('importFile').addEventListener('change', e => this.importData(e));
        document.getElementById('importZone').addEventListener('click', () => document.getElementById('importFile').click());
        document.getElementById('undoBtn').addEventListener('click', () => this.undo());
        document.getElementById('redoBtn').addEventListener('click', () => this.redo());

        // Close modals on escape
        ['entryModal', 'goalModal'].forEach(id => {
          document.getElementById(id).addEventListener('click', e => {
            if (e.target === document.getElementById(id)) this.closeModal(id);
          });
        });
      }

      handleDragStart(e) {
        e.dataTransfer.setData('text/plain', e.target.dataset.category);
        e.target.classList.add('dragging');
      }

      handleDragOver(e) {
        e.preventDefault();
        e.currentTarget.classList.add('drag-over');
      }

      handleDragLeave(e) {
        e.currentTarget.classList.remove('drag-over');
      }

      handleDrop(e) {
        e.preventDefault();
        e.currentTarget.classList.remove('drag-over');
        const category = e.dataTransfer.getData('text/plain');
        document.querySelectorAll('.category-tile').forEach(t => t.classList.remove('dragging'));
        this.showEntryModal(category);
      }

      showEntryModal(category) {
        document.getElementById('entryCategory').value = category;
        document.getElementById('entryValue').focus();
        document.getElementById('entryDate').value = new Date().toISOString().split('T')[0];
        this.updateValueHelp(category);
        document.getElementById('entryModal').style.display = 'flex';
        document.getElementById('entryModal').setAttribute('aria-hidden', 'false');
      }

      updateValueHelp(category) {
        const help = {
          transport: 'km driven',
          energy: 'kWh used',
          food: 'meals/serving',
          waste: 'items'
        };
        document.getElementById('valueHelp').textContent = help[category] || '';
      }

      saveEntry(e) {
        e.preventDefault();
        const category = document.getElementById('entryCategory').value;
        const value = parseFloat(document.getElementById('entryValue').value);
        const date = document.getElementById('entryDate').value;
        
        if (value < 0) return alert('Value cannot be negative');
        
        const entry = {
          id: Date.now(),
          date,
          category,
          value: value.toFixed(1),
          co2: value * this.settings.factors[category]
        };
        
        this.addHistoryState();
        this.entries.push(entry);
        this.pruneOldData();
        this.saveData();
        this.render();
        this.closeModal('entryModal');
      }

      saveGoal(e) {
        e.preventDefault();
        this.settings.weeklyGoal = parseFloat(document.getElementById('goalInput').value);
        this.addHistoryState();
        this.saveData();
        this.render();
        this.closeModal('goalModal');
      }

      toggleView(view) {
        this.currentView = view;
        document.querySelectorAll('[data-view]').forEach(btn => {
          btn.classList.toggle('active', btn.dataset.view === view);
          btn.setAttribute('aria-pressed', btn.dataset.view === view);
        });
        this.render();
      }

      render() {
        this.renderEntries();
        this.renderHeader();
        this.renderCharts();
        this.renderSuggestions();
        this.updateHistoryButtons();
      }

      renderEntries() {
        const list = document.getElementById('entriesList');
        const now = new Date();
        now.setHours(0,0,0,0);
        
        let filtered = this.entries.filter(e => {
          const entryDate = new Date(e.date + 'T00:00:00Z');
          if (this.currentView === 'daily') return entryDate.toDateString() === now.toDateString();
          return entryDate >= new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
        }).sort((a,b) => new Date(b.date) - new Date(a.date));

        list.innerHTML = filtered.map(entry => `
          <div class="entry ${entry.co2 > 5 ? 'co2-high' : ''}" data-id="${entry.id}">
            <div>
              <strong>${entry.category.toUpperCase()}: ${entry.value} 
                <span aria-label="CO2 emissions">${(entry.co2).toFixed(1)}kg</span>
              </strong>
              <div>${entry.date}</div>
            </div>
            <div>
              <button class="btn" onclick="tracker.editEntry(${entry.id})" aria-label="Edit entry">Edit</button>
              <button class="btn" onclick="tracker.deleteEntry(${entry.id})" aria-label="Delete entry">Delete</button>
            </div>
          </div>
        `).join('');

        // Bind edit/delete after render
        setTimeout(() => {
          document.querySelectorAll('.entry button').forEach(btn => {
            btn.addEventListener('click', e => {
              const id = parseInt(e.target.closest('.entry').dataset.id);
              if (e.target.textContent === 'Edit') this.editEntry(id);
              else this.deleteEntry(id);
            });
          });
        });
      }

      renderHeader() {
        const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
        const weeklyTotal = this.entries
          .filter(e => new Date(e.date) >= weekAgo)
          .reduce((sum, e) => sum + e.co2, 0);
        
        document.getElementById('weeklyTotal').textContent = `${weeklyTotal.toFixed(1)} kg CO2`;
        document.getElementById('goalValue').textContent = this.settings.weeklyGoal.toFixed(1);
        
        const progress = Math.min(100, (weeklyTotal / this.settings.weeklyGoal) * 100);
        document.getElementById('goalProgress').style.width = `${progress}%`;
      }

      renderCharts() {
        const ctx1 = document.getElementById('barChart').getContext('2d');
        const ctx2 = document.getElementById('pieChart').getContext('2d');
        
        // Bar chart - weekly by day
        const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
        const days = [];
        const dailyTotals = [];
        for (let i = 6; i >= 0; i--) {
          const day = new Date(Date.now() - i * 24 * 60 * 60 * 1000);
          days.push(day.toLocaleDateString('short'));
          dailyTotals.push(this.entries
            .filter(e => {
              const ed = new Date(e.date);
              return ed.toDateString() === day.toDateString();
            })
            .reduce((sum, e) => sum + e.co2, 0));
        }
        
        ctx1.clearRect(0, 0, ctx1.canvas.width, ctx1.canvas.height);
        const maxDaily = Math.max(...dailyTotals, 5);
        const barWidth = 40;
        dailyTotals.forEach((total, i) => {
          const height = (total / maxDaily) * 250;
          ctx1.fillStyle = `hsl(${120 - (total/maxDaily)*60}, 70%, 50%)`;
          ctx1.fillRect(i * 55 + 20, 300 - height, barWidth, height);
          ctx1.fillStyle = '#000';
          ctx1.font = '12px sans-serif';
          ctx1.textAlign = 'center';
          ctx1.fillText(total.toFixed(1), i * 55 + 40, 290);
          ctx1.fillText(days[i], i * 55 + 40, 320);
        });

        // Pie chart - category breakdown
        const catTotals = { transport: 0, energy: 0, food: 0, waste: 0 };
        this.entries.filter(e => new Date(e.date) >= weekAgo)
          .forEach(e => catTotals[e.category] += e.co2);
        
        const total = Object.values(catTotals).reduce((a,b) => a+b, 0);
        if (total > 0) {
          let startAngle = 0;
          Object.entries(catTotals).forEach(([cat, val], i) => {
            if (val === 0) return;
            const sliceAngle = (val / total) * 2 * Math.PI;
            ctx2.beginPath();
            ctx2.moveTo(200, 150);
            ctx2.arc(200, 150, 120, startAngle, startAngle + sliceAngle);
            ctx2.closePath();
            ctx2.fillStyle = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4'][i];
            ctx2.fill();
            startAngle += sliceAngle;
          });
        }
      }

      renderSuggestions() {
        const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
        const catTotals = {};
        this.entries.filter(e => new Date(e.date) >= weekAgo)
          .forEach(e => catTotals[e.category] = (catTotals[e.category] || 0) + e.co2);
        
        const highCats = Object.entries(catTotals)
          .filter(([_, val]) => val > 5)
          .sort((a,b) => b[1] - a[1]);
        
        const suggEl = document.getElementById('suggestions');
        if (highCats.length === 0) {
          suggEl.classList.add('hidden');
          return;
        }
        
        const tips = {
          transport: 'Bike/walk instead: saves 2kg per 10km',
          energy: 'Unplug devices: saves 1kg per kWh',
          food: 'Try vegetarian: saves 4kg per meal',
          waste: 'Recycle more: saves 0.5kg per 5 items'
        };
        
        suggEl.innerHTML = `
          <h3>üí° Suggestions</h3>
          ${highCats.slice(0,3).map(([cat]) => `
            <div class="suggestion">
              <span>${tips[cat]}</span>
              <button class="btn" onclick="this.parentElement.parentElement.removeChild(this.parentElement)">Dismiss</button>
            </div>
          `).join('')}
        `;
        suggEl.classList.remove('hidden');
      }

      recalcEntries() {
        this.entries.forEach(e => {
          e.co2 = parseFloat(e.value) * this.settings.factors[e.category];
        });
      }

      pruneOldData() {
        const cutoff = new Date(Date.now() - 90 * 24 * 60 * 60 * 1000);
        this.entries = this.entries.filter(e => new Date(e.date) >= cutoff);
      }

      editEntry(id) {
        const entry = this.entries.find(e => e.id === id);
        if (!entry) return;
        
        document.getElementById('entryCategory').value = entry.category;
        document.getElementById('entryValue').value = entry.value;
        document.getElementById('entryDate').value = entry.date;
        this.updateValueHelp(entry.category);
        
        this.addHistoryState();
        this.entries = this.entries.filter(e => e.id !== id);
        this.saveData();
        this.render();
        this.showEntryModal(entry.category);
      }

      deleteEntry(id) {
        this.addHistoryState();
        this.entries = this.entries.filter(e => e.id !== id);
        this.saveData();
        this.render();
      }

      addHistoryState() {
        this.history = this.history.slice(0, this.historyIndex + 1);
        this.history.push(JSON.stringify({ entries: this.entries, settings: this.settings }));
        if (this.history.length > 50) this.history.shift();
        this.historyIndex = this.history.length - 1;
      }

      undo() {
        if (this.historyIndex > 0) {
          this.historyIndex--;
          const state = JSON.parse(this.history[this.historyIndex]);
          this.entries = state.entries;
          this.settings = state.settings;
          this.render();
        }
      }

      redo() {
        if (this.historyIndex < this.history.length - 1) {
          this.historyIndex++;
          const state = JSON.parse(this.history[this.historyIndex]);
          this.entries = state.entries;
          this.settings = state.settings;
          this.render();
        }
      }

      updateHistoryButtons() {
        document.getElementById('undoBtn').disabled = this.historyIndex <= 0;
        document.getElementById('redoBtn').disabled = this.historyIndex >= this.history.length - 1;
      }

      showGoalModal() {
        document.getElementById('goalInput').value = this.settings.weeklyGoal;
        document.getElementById('goalModal').style.display = 'flex';
        document.getElementById('goalModal').setAttribute('aria-hidden', 'false');
      }

      closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
        document.getElementById(modalId).setAttribute('aria-hidden', 'true');
      }

      exportData() {
        const data = { entries: this.entries, settings: this.settings, timestamp: new Date().toISOString() };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `eco-tracker-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
      }

      importData(e) {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = ev => {
          try {
            const data = JSON.parse(ev.target.result);
            if (data.entries && data.settings) {
              this.addHistoryState();
              this.entries = data.entries;
              this.settings = data.settings;
              this.recalcEntries();
              this.pruneOldData();
              this.saveData();
              this.render();
              alert('Data imported successfully!');
            }
          } catch (err) {
            alert('Invalid JSON file');
          }
        };
        reader.readAsText(file);
      }

      handleKeydown(e) {
        if (e.ctrlKey || e.metaKey) {
          if (e.key === 'z') {
            e.preventDefault();
            this.undo();
          } else if (e.key === 'y') {
            e.preventDefault();
            this.redo();
          }
        }
        if (e.key === 'Escape') {
          document.querySelectorAll('.modal').forEach(modal => {
            if (modal.style.display === 'flex') this.closeModal(modal.id);
          });
        }
      }

      saveData() {
        try {
          localStorage.setItem('ecoData', JSON.stringify({ entries: this.entries, settings: this.settings }));
        } catch (e) {
          if (e.name === 'QuotaExceededError') {
            alert('Storage full. Data saved to sessionStorage as fallback.');
            sessionStorage.setItem('ecoData', JSON.stringify({ entries: this.entries, settings: this.settings }));
          }
        }
      }

      loadData() {
        try {
          const data = localStorage.getItem('ecoData');
          if (data) {
            const parsed = JSON.parse(data);
            this.entries = parsed.entries || [];
            this.settings = { ...this.settings, ...parsed.settings };
            this.recalcEntries();
          }
        } catch (e) {
          console.error('Load error:', e);
        }
      }
    }

    // Global tracker instance
    const tracker = new EcoCarbonTracker();
  </script>
</body>
</html>