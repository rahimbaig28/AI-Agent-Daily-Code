<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2025-12-10T01:28:37.896073Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Wellness Habit Tracker+</title>
<style>
  :root {
    --color-primary: #2a9d8f;
    --color-secondary: #264653;
    --color-bg: #fefefe;
    --color-text: #222;
    --color-completed: #2a9d8f;
    --color-pending: #e9c46a;
    --color-missed: #e76f51;
    --focus-outline: 3px solid #f4a261;
    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
  }
  html, body {
    margin: 0; padding: 0; height: 100%;
    font-family: var(--font-family);
    background: var(--color-bg);
    color: var(--color-text);
    line-height: 1.4;
  }
  body {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }
  header {
    background: var(--color-primary);
    color: white;
    padding: 1rem 1.5rem;
    text-align: center;
  }
  header h1 {
    margin: 0;
    font-weight: 600;
    font-size: 1.5rem;
  }
  main {
    flex: 1 0 auto;
    display: flex;
    flex-direction: column;
    max-width: 900px;
    margin: 1rem auto;
    padding: 0 1rem;
  }
  section {
    margin-bottom: 2rem;
  }
  h2 {
    border-bottom: 2px solid var(--color-primary);
    padding-bottom: 0.25rem;
    margin-bottom: 0.5rem;
    font-weight: 600;
  }
  button, input, select, textarea {
    font-family: var(--font-family);
    font-size: 1rem;
  }
  button {
    background: var(--color-primary);
    border: none;
    color: white;
    padding: 0.4rem 0.8rem;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }
  button:hover, button:focus {
    background: #21867a;
    outline: none;
  }
  button:focus-visible {
    outline: var(--focus-outline);
  }
  input[type="text"], input[type="number"], select {
    padding: 0.3rem 0.5rem;
    border: 1px solid #ccc;
    border-radius: 4px;
    width: 100%;
    box-sizing: border-box;
  }
  input[type="text"]:focus, input[type="number"]:focus, select:focus {
    border-color: var(--color-primary);
    outline: none;
    box-shadow: 0 0 3px var(--color-primary);
  }
  label {
    display: block;
    margin-bottom: 0.2rem;
    font-weight: 600;
  }
  .form-row {
    margin-bottom: 1rem;
  }
  .habit-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  .habit-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 0.5rem 0.75rem;
    margin-bottom: 0.5rem;
    background: white;
  }
  .habit-item > div {
    flex: 1;
  }
  .habit-controls button {
    margin-left: 0.5rem;
    background: transparent;
    color: var(--color-secondary);
    border: none;
    cursor: pointer;
    font-size: 1.1rem;
  }
  .habit-controls button:hover, .habit-controls button:focus {
    color: var(--color-primary);
    outline: none;
  }
  .habit-controls button:focus-visible {
    outline: var(--focus-outline);
  }
  .daily-checkin {
    overflow-x: auto;
  }
  .calendar {
    border-collapse: collapse;
    width: 100%;
    min-width: 600px;
  }
  .calendar th, .calendar td {
    border: 1px solid #ddd;
    text-align: center;
    padding: 0.3rem 0.4rem;
    user-select: none;
  }
  .calendar th {
    background: var(--color-primary);
    color: white;
    position: sticky;
    top: 0;
    z-index: 1;
  }
  .calendar td {
    cursor: pointer;
  }
  .calendar td:focus {
    outline: var(--focus-outline);
  }
  .calendar td.completed {
    background-color: var(--color-completed);
    color: white;
  }
  .calendar td.pending {
    background-color: var(--color-pending);
    color: #333;
  }
  .calendar td.missed {
    background-color: var(--color-missed);
    color: white;
  }
  .calendar td.today {
    box-shadow: inset 0 0 0 2px var(--color-secondary);
  }
  .legend {
    display: flex;
    gap: 1rem;
    margin-top: 0.5rem;
    flex-wrap: wrap;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }
  .legend-color {
    width: 16px;
    height: 16px;
    border-radius: 3px;
  }
  .legend-completed { background: var(--color-completed); }
  .legend-pending { background: var(--color-pending); }
  .legend-missed { background: var(--color-missed); }
  .stats-panel {
    background: white;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 1rem;
  }
  .stats-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 0.5rem;
  }
  .stats-row:last-child {
    margin-bottom: 0;
  }
  .stats-label {
    font-weight: 600;
  }
  .undo-redo {
    margin-bottom: 1rem;
  }
  .undo-redo button {
    margin-right: 0.5rem;
  }
  .import-export {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
  }
  .import-export > * {
    flex: 1 1 200px;
  }
  .file-input-label {
    display: inline-block;
    background: var(--color-primary);
    color: white;
    padding: 0.4rem 0.8rem;
    border-radius: 4px;
    cursor: pointer;
    text-align: center;
  }
  .file-input-label:hover, .file-input-label:focus {
    background: #21867a;
    outline: none;
  }
  .file-input-label:focus-visible {
    outline: var(--focus-outline);
  }
  input[type="file"] {
    display: none;
  }
  @media (max-width: 700px) {
    .calendar {
      min-width: 100%;
      font-size: 0.85rem;
    }
  }
  @media print {
    body {
      background: white;
      color: black;
      font-size: 12pt;
    }
    header, .undo-redo, .import-export, button, input, select, textarea, .habit-controls {
      display: none !important;
    }
    main {
      max-width: none;
      margin: 0;
      padding: 0;
    }
    .calendar {
      border: 1px solid #000;
      page-break-inside: avoid;
    }
    .calendar th, .calendar td {
      border: 1px solid #000;
      padding: 0.2rem 0.3rem;
    }
    .calendar td.completed {
      background-color: #000;
      color: white;
    }
    .calendar td.pending {
      background-color: #666;
      color: white;
    }
    .calendar td.missed {
      background-color: #999;
      color: white;
    }
  }
</style>
</head>
<body>
<header>
  <h1>Wellness Habit Tracker+</h1>
</header>
<main>
  <section aria-label="Manage Habits">
    <h2>Habits</h2>
    <form id="habit-form" aria-describedby="habit-form-desc">
      <p id="habit-form-desc" class="sr-only">Add or edit a wellness habit with a name and target frequency per week.</p>
      <div class="form-row">
        <label for="habit-name">Habit Name</label>
        <input type="text" id="habit-name" name="habit-name" required aria-required="true" autocomplete="off" />
      </div>
      <div class="form-row">
        <label for="habit-target">Target Frequency (times per week)</label>
        <input type="number" id="habit-target" name="habit-target" min="1" max="7" value="7" required aria-required="true" />
      </div>
      <div class="form-row">
        <button type="submit" id="habit-submit-btn">Add Habit</button>
        <button type="button" id="habit-cancel-btn" hidden>Cancel Edit</button>
      </div>
    </form>
    <ul id="habit-list" class="habit-list" aria-live="polite" aria-relevant="additions removals"></ul>
  </section>

  <section aria-label="Daily Check-in">
    <h2>Daily Check-in</h2>
    <div class="undo-redo" role="group" aria-label="Undo and Redo actions">
      <button id="undo-btn" aria-disabled="true" title="Undo last action" aria-label="Undo last action">Undo</button>
      <button id="redo-btn" aria-disabled="true" title="Redo last undone action" aria-label="Redo last undone action">Redo</button>
    </div>
    <div class="daily-checkin" tabindex="0" aria-label="Calendar view of habit completion status">
      <table class="calendar" id="calendar" role="grid" aria-readonly="true" aria-describedby="calendar-legend">
        <thead>
          <tr>
            <th scope="col" aria-label="Habit">Habit</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <div class="legend" id="calendar-legend" aria-label="Color legend for habit completion status">
      <div class="legend-item"><div class="legend-color legend-completed" aria-hidden="true"></div> Completed</div>
      <div class="legend-item"><div class="legend-color legend-pending" aria-hidden="true"></div> Pending</div>
      <div class="legend-item"><div class="legend-color legend-missed" aria-hidden="true"></div> Missed</div>
    </div>
  </section>

  <section aria-label="Statistics">
    <h2>Statistics</h2>
    <div class="stats-panel" aria-live="polite" aria-atomic="true" id="stats-panel">
      <p>Loading statistics...</p>
    </div>
  </section>

  <section aria-label="Data Import and Export">
    <h2>Backup & Restore</h2>
    <div class="import-export">
      <button id="export-btn" aria-label="Export all data as JSON file">Export Data</button>
      <label for="import-file" class="file-input-label" tabindex="0">Import Data</label>
      <input type="file" id="import-file" accept="application/json" aria-label="Import JSON data file" />
    </div>
  </section>
</main>
<script>
(() => {
  "use strict";

  // Constants
  const STORAGE_KEY = "wellness-habit-tracker-data-v1";
  const MAX_UNDO_STACK = 100;

  // State
  let state = {
    habits: [],
    dailyLogs: {}, // { habitId: { 'YYYY-MM-DD': true|false } }
  };
  let undoStack = [];
  let redoStack = [];
  let editingHabitId = null;

  // DOM Elements
  const habitForm = document.getElementById("habit-form");
  const habitNameInput = document.getElementById("habit-name");
  const habitTargetInput = document.getElementById("habit-target");
  const habitSubmitBtn = document.getElementById("habit-submit-btn");
  const habitCancelBtn = document.getElementById("habit-cancel-btn");
  const habitList = document.getElementById("habit-list");
  const calendarTable = document.getElementById("calendar");
  const calendarTbody = calendarTable.querySelector("tbody");
  const undoBtn = document.getElementById("undo-btn");
  const redoBtn = document.getElementById("redo-btn");
  const statsPanel = document.getElementById("stats-panel");
  const exportBtn = document.getElementById("export-btn");
  const importFileInput = document.getElementById("import-file");

  // Utility Functions
  function saveState() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  }
  function loadState() {
    const data = localStorage.getItem(STORAGE_KEY);
    if (data) {
      try {
        const parsed = JSON.parse(data);
        if (parsed && typeof parsed === "object") {
          if (Array.isArray(parsed.habits) && typeof parsed.dailyLogs === "object") {
            state = parsed;
          }
        }
      } catch {}
    }
  }
  function cloneState() {
    return JSON.parse(JSON.stringify(state));
  }
  function pushUndo() {
    undoStack.push(cloneState());
    if (undoStack.length > MAX_UNDO_STACK) undoStack.shift();
    redoStack = [];
    updateUndoRedoButtons();
  }
  function undo() {
    if (undoStack.length === 0) return;
    redoStack.push(cloneState());
    state = undoStack.pop();
    saveState();
    renderAll();
    updateUndoRedoButtons();
  }
  function redo() {
    if (redoStack.length === 0) return;
    undoStack.push(cloneState());
    state = redoStack.pop();
    saveState();
    renderAll();
    updateUndoRedoButtons();
  }
  function updateUndoRedoButtons() {
    undoBtn.disabled = undoStack.length === 0;
    redoBtn.disabled = redoStack.length === 0;
    undoBtn.setAttribute("aria-disabled", undoBtn.disabled.toString());
    redoBtn.setAttribute("aria-disabled", redoBtn.disabled.toString());
  }
  function formatDate(date) {
    return date.toISOString().slice(0, 10);
  }
  function parseDate(str) {
    const d = new Date(str);
    return isNaN(d) ? null : d;
  }
  function getToday() {
    const now = new Date();
    return formatDate(now);
  }
  function daysBetween(date1, date2) {
    const d1 = new Date(date1);
    const d2 = new Date(date2);
    return Math.floor((d2 - d1) / (1000 * 60 * 60 * 24));
  }
  function addDays(dateStr, days) {
    const d = new Date(dateStr);
    d.setDate(d.getDate() + days);
    return formatDate(d);
  }
  function generateId() {
    return "h" + Math.random().toString(36).slice(2, 10);
  }
  function isToday(dateStr) {
    return dateStr === getToday();
  }
  function ariaBool(value) {
    return value ? "true" : "false";
  }

  // Habit Management
  function addHabit(name, target) {
    const id = generateId();
    state.habits.push({ id, name, target: Number(target) });
    state.dailyLogs[id] = {};
    pushUndo();
    saveState();
    renderHabits();
    renderCalendar();
    renderStats();
  }
  function updateHabit(id, name, target) {
    const habit = state.habits.find(h => h.id === id);
    if (!habit) return;
    habit.name = name;
    habit.target = Number(target);
    pushUndo();
    saveState();
    renderHabits();
    renderCalendar();
    renderStats();
  }
  function deleteHabit(id) {
    state.habits = state.habits.filter(h => h.id !== id);
    delete state.dailyLogs[id];
    pushUndo();
    saveState();
    renderHabits();
    renderCalendar();
    renderStats();
  }

  // Daily Check-in Management
  // We show a calendar of last 30 days including today
  function getCalendarDates() {
    const today = new Date();
    const dates = [];
    for (let i = 29; i >= 0; i--) {
      const d = new Date(today);
      d.setDate(d.getDate() - i);
      dates.push(formatDate(d));
    }
    return dates;
  }
  function toggleHabitCompletion(habitId, date) {
    if (!state.dailyLogs[habitId]) state.dailyLogs[habitId] = {};
    const current = state.dailyLogs[habitId][date];
    // Cycle: undefined or false -> true, true -> false
    if (current === true) {
      state.dailyLogs[habitId][date] = false;
    } else {
      state.dailyLogs[habitId][date] = true;
    }
    pushUndo();
    saveState();
    renderCalendar();
    renderStats();
  }

  // Rendering
  function renderHabits() {
    habitList.innerHTML = "";
    if (state.habits.length === 0) {
      const li = document.createElement("li");
      li.textContent = "No habits added yet.";
      habitList.appendChild(li);
      return;
    }
    state.habits.forEach(habit => {
      const li = document.createElement("li");
      li.className = "habit-item";
      li.setAttribute("data-habit-id", habit.id);
      li.tabIndex = 0;
      li.setAttribute("role", "listitem");

      const divName = document.createElement("div");
      divName.textContent = habit.name + " (Target: " + habit.target + "/week)";
      divName.title = "Habit: " + habit.name + ", Target frequency: " + habit.target + " times per week";
      li.appendChild(divName);

      const controls = document.createElement("div");
      controls.className = "habit-controls";

      const editBtn = document.createElement("button");
      editBtn.type = "button";
      editBtn.title = "Edit habit " + habit.name;
      editBtn.setAttribute("aria-label", "Edit habit " + habit.name);
      editBtn.textContent = "âœï¸";
      editBtn.addEventListener("click", () => startEditHabit(habit.id));
      controls.appendChild(editBtn);

      const delBtn = document.createElement("button");
      delBtn.type = "button";
      delBtn.title = "Delete habit " + habit.name;
      delBtn.setAttribute("aria-label", "Delete habit " + habit.name);
      delBtn.textContent = "ðŸ—‘ï¸";
      delBtn.addEventListener("click", () => {
        if (confirm(`Delete habit "${habit.name}"? This action cannot be undone.`)) {
          deleteHabit(habit.id);
          if (editingHabitId === habit.id) cancelEditHabit();
        }
      });
      controls.appendChild(delBtn);

      li.appendChild(controls);
      habitList.appendChild(li);
    });
  }
  function renderCalendar() {
    // Clear previous header date columns except first column
    const theadRow = calendarTable.tHead.rows;
    while (theadRow.cells.length > 1) theadRow.deleteCell(1);

    const dates = getCalendarDates();
    dates.forEach(date => {
      const th = document.createElement("th");
      th.scope = "col";
      th.textContent = date.slice(5);
      th.title = date;
      theadRow.appendChild(th);
    });

    calendarTbody.innerHTML = "";
    if (state.habits.length === 0) {
      const tr = document.createElement("tr");
      const td = document.createElement("td");
      td.colSpan = dates.length + 1;
      td.textContent = "Add habits to start tracking.";
      tr.appendChild(td);
      calendarTbody.appendChild(tr);
      return;
    }

    state.habits.forEach(habit => {
      const tr = document.createElement("tr");
      tr.setAttribute("data-habit-id", habit.id);

      const tdName = document.createElement("td");
      tdName.textContent = habit.name;
      tdName.style.textAlign = "left";
      tdName.tabIndex = -1;
      tr.appendChild(tdName);

      dates.forEach(date => {
        const td = document.createElement("td");
        td.tabIndex = 0;
        td.setAttribute("role", "gridcell");
        td.setAttribute("aria-label", `${habit.name} on ${date}: `);

        const status = state.dailyLogs[habit.id]?.[date];
        if (status === true) {
          td.classList.add("completed");
          td.setAttribute("aria-checked", "true");
          td.setAttribute("aria-label", `${habit.name} on ${date}: Completed`);
        } else if (status === false) {
          td.classList.add("missed");
          td.setAttribute("aria-checked", "false");
          td.setAttribute("aria-label", `${habit.name} on ${date}: Marked as not completed`);
        } else {
          td.classList.add("pending");
          td.setAttribute("aria-checked", "false");
          td.setAttribute("aria-label", `${habit.name} on ${date}: Not marked`);
        }
        if (isToday(date)) {
          td.classList.add("today");
        }
        td.addEventListener("click", () => toggleHabitCompletion(habit.id, date));
        td.addEventListener("keydown", e => {
          if (e.key === " " || e.key === "Enter") {
            e.preventDefault();
            toggleHabitCompletion(habit.id, date);
          }
        });
        tr.appendChild(td);
      });
      calendarTbody.appendChild(tr);
    });
  }
  function renderStats() {
    if (state.habits.length === 0) {
      statsPanel.innerHTML = "<p>Add habits to see statistics.</p>";
      return;
    }
    const dates = getCalendarDates();
    const stats = state.habits.map(habit => {
      const logs = state.dailyLogs[habit.id] || {};
      let completedCount = 0;
      let currentStreak = 0;
      let maxStreak = 0;
      let streak = 0;

      // Count completed in last 7 days (weekly)
      const last7Days = dates.slice(-7);
      let weeklyCompleted = 0;
      last7Days.forEach(d => {
        if (logs[d] === true) weeklyCompleted++;
      });

      // Count completed in last 30 days (monthly)
      let monthlyCompleted = 0;
      dates.forEach(d => {
        if (logs[d] === true) monthlyCompleted++;
      });

      // Calculate streaks (consecutive days completed)
      for (let i = dates.length - 1; i >= 0; i--) {
        const d = dates[i];
        if (logs[d] === true) {
          streak++;
          if (streak > maxStreak) maxStreak = streak;
        } else {
          streak = 0;
        }
      }
      currentStreak = streak;

      return {
        name: habit.name,
        weeklyCompletionRate: (weeklyCompleted / 7 * 100).toFixed(0),
        monthlyCompletionRate: (monthlyCompleted / 30 * 100).toFixed(0),
        currentStreak,
        maxStreak,
      };
    });

    // Build stats HTML
    const container = document.createElement("div");
    stats.forEach(s => {
      const div = document.createElement("div");
      div.className = "stats-row";
      div.innerHTML = `<div class="stats-label">${s.name}</div>
        <div>Weekly: ${s.weeklyCompletionRate}%</div>
        <div>Monthly: ${s.monthlyCompletionRate}%</div>
        <div>Current Streak: ${s.currentStreak}d</div>
        <div>Max Streak: ${s.maxStreak}d</div>`;
      container.appendChild(div);
    });
    statsPanel.innerHTML = "";
    statsPanel.appendChild(container);
  }

  // Habit Form Handlers
  function startEditHabit(id) {
    const habit = state.habits.find(h => h.id === id);
    if (!habit) return;
    editingHabitId = id;
    habitNameInput.value = habit.name;
    habitTargetInput.value = habit.target;
    habitSubmitBtn.textContent = "Save Habit";
    habitCancelBtn.hidden = false;
    habitNameInput.focus();
  }
  function cancelEditHabit() {
    editingHabitId = null;
    habitForm.reset();
    habitSubmitBtn.textContent = "Add Habit";
    habitCancelBtn.hidden = true;
  }
  habitForm.addEventListener("submit", e => {
    e.preventDefault();
    const name = habitNameInput.value.trim();
    const target = habitTargetInput.value.trim();
    if (!name || !target || isNaN(target) || target < 1 || target > 7) {
      alert("Please enter a valid habit name and target frequency (1-7).");
      return;
    }
    if (editingHabitId) {
      updateHabit(editingHabitId, name, target);
      cancelEditHabit();
    } else {
      addHabit(name, target);
      habitForm.reset();
      habitNameInput.focus();
    }
  });
  habitCancelBtn.addEventListener("click", () => {
    cancelEditHabit();
  });

  // Undo/Redo Handlers
  undoBtn.addEventListener("click", () => undo());
  redoBtn.addEventListener("click", () => redo());

  // Export/Import Handlers
  exportBtn.addEventListener("click", () => {
    const dataStr = JSON.stringify(state, null, 2);
    const blob = new Blob([dataStr], { type: "application/json" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "wellness-habit-tracker-data.json";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  });
  importFileInput.addEventListener("change", e => {
    const file = e.target.files;
    if (!file) return;
    const reader = new FileReader();
    reader.onload = event => {
      try {
        const imported = JSON.parse(event.target.result);
        if (
          imported &&
          Array.isArray(imported.habits) &&
          typeof imported.dailyLogs === "object"
        ) {
          if (
            confirm(
              "Importing data will overwrite your current habits and logs. Continue?"
            )
          ) {
            pushUndo();
            state = imported;
            saveState();
            renderAll();
          }
        } else {
          alert("Invalid data format.");
        }
      } catch {
        alert("Failed to parse JSON file.");
      }
    };
    reader.readAsText(file);
    e.target.value = "";
  });

  // Accessibility helper: screen reader only text
  const style = document.createElement("style");
  style.textContent = `.sr-only {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    padding: 0 !important;
    margin: -1px !important;
    overflow: hidden !important;
    clip: rect(0,0,0,0) !important;
    border: 0 !important;
  }`;
  document.head.appendChild(style);

  // Initial load
  function renderAll() {
    renderHabits();
    renderCalendar();
    renderStats();
  }
  loadState();
  renderAll();
  updateUndoRedoButtons();
})();
</script>
</body>
</html>