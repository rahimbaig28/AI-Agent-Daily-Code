<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2025-11-25T13:31:31.140885Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Accessible Note Taker</title>
  <style>
    :root {
      --bg: #fff;
      --text: #000;
      --border: #ccc;
      --focus: #005fcc;
      --hover-bg: #f0f0f0;
      --btn-bg: #0078d7;
      --btn-text: #fff;
      --btn-hover: #005a9e;
      --delete-bg: #d73a49;
      --delete-hover: #b32a3a;
    }
    body {
      margin: 0;
      font-family: sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
    }
    .container {
      max-width: 800px;
      margin: 1rem auto;
      padding: 1rem;
    }
    .form {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    .form textarea {
      min-height: 80px;
      padding: 0.5rem;
      border: 2px solid var(--border);
      border-radius: 4px;
      font-size: 1rem;
      resize: vertical;
    }
    .form textarea:focus {
      outline: 2px solid var(--focus);
      outline-offset: 2px;
    }
    .form button {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 4px;
      font-size: 1rem;
      cursor: pointer;
    }
    .form button.save {
      background: var(--btn-bg);
      color: var(--btn-text);
    }
    .form button.save:hover,
    .form button.save:focus {
      background: var(--btn-hover);
    }
    .form button.delete {
      background: var(--delete-bg);
      color: var(--btn-text);
    }
    .form button.delete:hover,
    .form button.delete:focus {
      background: var(--delete-hover);
    }
    .controls {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    .controls button {
      padding: 0.5rem 1rem;
      border: 2px solid var(--border);
      border-radius: 4px;
      background: var(--bg);
      color: var(--text);
      cursor: pointer;
    }
    .controls button:hover,
    .controls button:focus {
      background: var(--hover-bg);
      outline: 2px solid var(--focus);
      outline-offset: 2px;
    }
    .notes {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .note {
      padding: 0.75rem;
      border: 2px solid var(--border);
      border-radius: 4px;
      margin-bottom: 0.5rem;
      position: relative;
    }
    .note:focus {
      outline: 2px solid var(--focus);
      outline-offset: 2px;
    }
    .note-actions {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    .note-actions button {
      padding: 0.25rem 0.5rem;
      border: 2px solid var(--border);
      border-radius: 4px;
      background: var(--bg);
      color: var(--text);
      cursor: pointer;
      font-size: 0.875rem;
    }
    .note-actions button:hover,
    .note-actions button:focus {
      background: var(--hover-bg);
      outline: 2px solid var(--focus);
      outline-offset: 2px;
    }
    .note-actions button.delete {
      background: var(--delete-bg);
      color: var(--btn-text);
    }
    .note-actions button.delete:hover,
    .note-actions button.delete:focus {
      background: var(--delete-hover);
    }
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
    @media (prefers-contrast: high) {
      :root {
        --border: #000;
        --focus: #000;
      }
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #111;
        --text: #fff;
        --border: #555;
        --hover-bg: #333;
        --btn-bg: #005a9e;
        --btn-hover: #004070;
        --delete-bg: #b32a3a;
        --delete-hover: #8a1f2c;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Accessible Note Taker</h1>
    <div class="controls">
      <button id="undo" aria-label="Undo last action">Undo</button>
      <button id="redo" aria-label="Redo last undone action">Redo</button>
    </div>
    <form id="note-form" class="form">
      <label for="note-text">Note:</label>
      <textarea id="note-text" aria-describedby="note-help" placeholder="Type your note here"></textarea>
      <div id="note-help" class="sr-only">Press Enter to save, Escape to cancel.</div>
      <div>
        <button type="submit" class="save">Save Note</button>
        <button type="button" id="cancel" class="save">Cancel</button>
        <button type="button" id="delete-note" class="delete" style="display:none;">Delete Note</button>
      </div>
    </form>
    <ul id="notes-list" class="notes" role="list"></ul>
    <div id="status" class="sr-only" aria-live="polite"></div>
  </div>

  <script>
    // State
    let notes = [];
    let undoStack = [];
    let redoStack = [];
    let editingId = null;
    const noteForm = document.getElementById('note-form');
    const noteText = document.getElementById('note-text');
    const cancelBtn = document.getElementById('cancel');
    const deleteNoteBtn = document.getElementById('delete-note');
    const notesList = document.getElementById('notes-list');
    const undoBtn = document.getElementById('undo');
    const redoBtn = document.getElementById('redo');
    const statusEl = document.getElementById('status');

    // Utility: Generate unique ID
    function generateId() {
      return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }

    // Utility: Announce to screen reader
    function announce(message) {
      statusEl.textContent = '';
      setTimeout(() => {
        statusEl.textContent = message;
      }, 100);
    }

    // Save state to localStorage
    function saveState() {
      localStorage.setItem('notes', JSON.stringify(notes));
      localStorage.setItem('undoStack', JSON.stringify(undoStack));
      localStorage.setItem('redoStack', JSON.stringify(redoStack));
    }

    // Load state from localStorage
    function loadState() {
      const savedNotes = localStorage.getItem('notes');
      const savedUndo = localStorage.getItem('undoStack');
      const savedRedo = localStorage.getItem('redoStack');
      if (savedNotes) notes = JSON.parse(savedNotes);
      if (savedUndo) undoStack = JSON.parse(savedUndo);
      if (savedRedo) redoStack = JSON.parse(savedRedo);
    }

    // Update URL hash with encoded notes
    function updateHash() {
      const hash = btoa(JSON.stringify(notes));
      history.replaceState(null, '', '#' + hash);
    }

    // Restore notes from URL hash
    function restoreFromHash() {
      if (location.hash) {
        try {
          const hash = location.hash.substring(1);
          const decoded = JSON.parse(atob(hash));
          if (Array.isArray(decoded)) {
            notes = decoded;
            renderNotes();
            announce('Notes restored from URL.');
          }
        } catch (e) {
          console.warn('Failed to restore from hash:', e);
        }
      }
    }

    // Render all notes
    function renderNotes() {
      notesList.innerHTML = '';
      notes.forEach(note => {
        const li = document.createElement('li');
        li.className = 'note';
        li.setAttribute('role', 'listitem');
        li.setAttribute('tabindex', '0');
        li.innerHTML = `
          <div>${note.text}</div>
          <div class="note-actions">
            <button type="button" data-id="${note.id}" class="edit" aria-label="Edit note">Edit</button>
            <button type="button" data-id="${note.id}" class="delete" aria-label="Delete note">Delete</button>
          </div>
        `;
        notesList.appendChild(li);
      });
      // Attach event listeners after rendering
      attachNoteListeners();
    }

    // Attach event listeners to note actions
    function attachNoteListeners() {
      document.querySelectorAll('.edit').forEach(btn => {
        btn.addEventListener('click', editNote);
      });
      document.querySelectorAll('.delete').forEach(btn => {
        btn.addEventListener('click', deleteNote);
      });
    }

    // Start editing a note
    function editNote(e) {
      const id = e.target.dataset.id;
      const note = notes.find(n => n.id === id);
      if (note) {
        noteText.value = note.text;
        editingId = id;
        deleteNoteBtn.style.display = 'inline-block';
        noteText.focus();
        announce('Editing note.');
      }
    }

    // Delete a note
    function deleteNote(e) {
      const id = e.target.dataset.id;
      const note = notes.find(n => n.id === id);
      if (note) {
        const index = notes.findIndex(n => n.id === id);
        const action = { type: 'delete', note: { ...note }, index };
        undoStack.push(action);
        redoStack = [];
        notes.splice(index, 1);
        renderNotes();
        saveState();
        updateHash();
        announce('Note deleted.');
      }
    }

    // Form submission: save or update note
    noteForm.addEventListener('submit', e => {
      e.preventDefault();
      const text = noteText.value.trim();
      if (!text) return;
      if (editingId) {
        const note = notes.find(n => n.id === editingId);
        if (note) {
          const action = { type: 'edit', oldText: note.text, id: editingId };
          undoStack.push(action);
          redoStack = [];
          note.text = text;
          announce('Note updated.');
        }
      } else {
        const newNote = { id: generateId(), text };
        notes.push(newNote);
        undoStack.push({ type: 'add', id: newNote.id });
        redoStack = [];
        announce('Note added.');
      }
      noteText.value = '';
      editingId = null;
      deleteNoteBtn.style.display = 'none';
      renderNotes();
      saveState();
      updateHash();
    });

    // Cancel editing
    cancelBtn.addEventListener('click', () => {
      noteText.value = '';
      editingId = null;
      deleteNoteBtn.style.display = 'none';
      noteText.focus();
      announce('Edit cancelled.');
    });

    // Delete current note in editor
    deleteNoteBtn.addEventListener('click', () => {
      if (editingId) {
        const note = notes.find(n => n.id === editingId);
        if (note) {
          const index = notes.findIndex(n => n.id === editingId);
          const action = { type: 'delete', note: { ...note }, index };
          undoStack.push(action);
          redoStack = [];
          notes.splice(index, 1);
          noteText.value = '';
          editingId = null;
          deleteNoteBtn.style.display = 'none';
          renderNotes();
          saveState();
          updateHash();
          announce('Note deleted.');
        }
      }
    });

    // Undo last action
    undoBtn.addEventListener('click', () => {
      if (undoStack.length === 0) return;
      const action = undoStack.pop();
      redoStack.push(action);
      switch (action.type) {
        case 'add':
          notes = notes.filter(n => n.id !== action.id);
          break;
        case 'edit':
          const note = notes.find(n => n.id === action.id);
          if (note) note.text = action.oldText;
          break;
        case 'delete':
          notes.splice(action.index, 0, action.note);
          break;
      }
      renderNotes();
      saveState();
      updateHash();
      announce('Undo performed.');
    });

    // Redo last undone action
    redoBtn.addEventListener('click', () => {
      if (redoStack.length === 0) return;
      const action = redoStack.pop();
      undoStack.push(action);
      switch (action.type) {
        case 'add':
          const note = notes.find(n => n.id === action.id);
          if (!note) {
            const savedNote = JSON.parse(localStorage.getItem('notes')).find(n => n.id === action.id);
            if (savedNote) notes.push(savedNote);
          }
          break;
        case 'edit':
          const noteEdit = notes.find(n => n.id === action.id);
          if (noteEdit) noteEdit.text = action.oldText;
          break;
        case 'delete':
          notes.splice(action.index, 1);
          break;
      }
      renderNotes();
      saveState();
      updateHash();
      announce('Redo performed.');
    });

    // Keyboard navigation for notes list
    notesList.addEventListener('keydown', e => {
      if (e.key === 'Enter' || e.key === ' ') {
        const button = e.target.closest('button');
        if (button) button.click();
      }
    });

    // Initialize
    loadState();
    renderNotes();
    restoreFromHash();
    updateHash();
  </script>
</body>
</html>