<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2026-01-07T08:28:53.113590Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carbon Footprint Logger</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; line-height: 1.6; color: #333; background: #f8f9fa; padding: 1rem; }
        .container { max-width: 1200px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 2rem; }
        header h1 { color: #2c3e50; margin-bottom: 0.5rem; }
        .totals { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem; }
        .total-card { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; }
        .total-value { font-size: 2rem; font-weight: bold; }
        .day { color: #3498db; } .week { color: #27ae60; } .month { color: #e67e22; }
        .progress-section { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        .progress-bar { width: 100%; height: 12px; background: #ecf0f1; border-radius: 6px; overflow: hidden; margin: 1rem 0; }
        .progress-fill { height: 100%; transition: width 0.3s; border-radius: 6px; }
        .safe { background: #27ae60; } .warning { background: #f39c12; } .danger { background: #e74c3c; }
        .form-section { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        .form-grid { display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: end; }
        @media (max-width: 768px) { .form-grid { grid-template-columns: 1fr; } }
        select, input, textarea, button { padding: 0.75rem; border: 2px solid #ddd; border-radius: 8px; font-size: 1rem; }
        select:focus, input:focus, textarea:focus { outline: none; border-color: #3498db; }
        button { background: #3498db; color: white; border: none; cursor: pointer; font-weight: 600; transition: background 0.2s; }
        button:hover { background: #2980b9; }
        button.danger { background: #e74c3c; }
        button.danger:hover { background: #c0392b; }
        .activities { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem; }
        @media (max-width: 768px) { .activities { grid-template-columns: 1fr; } }
        .activity { background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 10px rgba(0,0,0,0.1); cursor: grab; position: relative; transition: all 0.2s; }
        .activity:active { cursor: grabbing; }
        .activity.selected { box-shadow: 0 4px 20px rgba(52,152,219,0.3); border: 2px solid #3498db; }
        .activity.transport { border-left: 5px solid #3498db; } .activity.energy { border-left: 5px solid #27ae60; }
        .activity.food { border-left: 5px solid #e67e22; } .activity.shopping { border-left: 5px solid #e74c3c; }
        .activity-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
        .activity-emissions { font-size: 1.2rem; font-weight: bold; }
        .activity-details { font-size: 0.9rem; color: #666; margin-bottom: 0.5rem; }
        .delete-btn { background: #e74c3c; padding: 0.25rem 0.5rem; font-size: 0.8rem; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
        .stat-card { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; }
        .share-btn { background: #27ae60; margin-top: 1rem; width: 100%; }
        .hidden { display: none; }
        @media (min-width: 769px) { .desktop-two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üåç Carbon Footprint Logger</h1>
            <p>Track your daily emissions and work toward sustainability</p>
        </header>

        <div class="totals">
            <div class="total-card">
                <div class="total-value day" aria-live="polite" id="day-total">0 kg</div>
                <div>Today</div>
            </div>
            <div class="total-card">
                <div class="total-value week" aria-live="polite" id="week-total">0 kg</div>
                <div>This Week</div>
            </div>
            <div class="total-card">
                <div class="total-value month" aria-live="polite" id="month-total">0 kg</div>
                <div>This Month</div>
            </div>
        </div>

        <div class="progress-section">
            <h2>Weekly Progress (Target: 50kg CO‚ÇÇ)</h2>
            <div class="progress-bar">
                <div class="progress-fill safe" id="progress-fill" style="width: 0%"></div>
            </div>
            <div id="progress-text">0 / 50 kg (0% of target)</div>
        </div>

        <section class="form-section" role="form">
            <h2>Add Activity</h2>
            <form id="activity-form" class="form-grid">
                <label for="activity-type">
                    <span>Activity Type</span>
                    <select id="activity-type" aria-label="Select activity type" required>
                        <option value="">Choose...</option>
                        <option value="transport">üöó Transport</option>
                        <option value="energy">‚ö° Energy</option>
                        <option value="food">üçé Food</option>
                        <option value="shopping">üõí Shopping</option>
                    </select>
                </label>
                <label for="quantity">
                    <span>Quantity/Duration</span>
                    <input type="number" id="quantity" aria-label="Enter quantity or duration" min="0" step="0.1" required>
                    <span id="unit"></span>
                </label>
                <div>
                    <label for="notes">
                        <span>Notes (optional)</span>
                        <textarea id="notes" aria-label="Add notes" rows="2" maxlength="100"></textarea>
                    </label>
                    <button type="submit">Add Activity</button>
                </div>
            </form>
        </section>

        <section class="desktop-two-col">
            <div>
                <h2>Today's Activities <button id="share-btn" class="share-btn" type="button">üì§ Share Today</button></h2>
                <ul id="activities-list" role="list" aria-label="List of today's activities"></ul>
            </div>
            <div>
                <h2>Summary Stats</h2>
                <div class="stats">
                    <div class="stat-card">
                        <div id="highest-category" style="font-size: 1.5rem; font-weight: bold;">‚Äî</div>
                        <div>Highest Emission Category</div>
                    </div>
                    <div class="stat-card">
                        <div id="daily-average">‚Äî</div>
                        <div>Daily Average</div>
                    </div>
                    <div class="stat-card">
                        <div id="carbon-saved" style="color: #27ae60;">+0 kg</div>
                        <div>vs Baseline (70kg/week)</div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Emission factors (kg CO2e per unit)
        const EMISSION_FACTORS = {
            transport: { factor: 0.2, unit: 'km' }, // car per km
            energy: { factor: 0.5, unit: 'kWh' },   // electricity per kWh
            food: { factor: 2.5, unit: 'kg' },      // average food per kg
            shopping: { factor: 5, unit: '‚Ç¨' }      // consumption per euro
        };

        // Colors for categories
        const CATEGORY_COLORS = {
            transport: '#3498db',
            energy: '#27ae60',
            food: '#e67e22',
            shopping: '#e74c3c'
        };

        let activities = JSON.parse(localStorage.getItem('carbon-activities') || '[]');
        let selectedActivityId = null;
        const WEEKLY_TARGET = 50;

        // Initialize
        function init() {
            loadActivities();
            updateDisplay();
            setupEventListeners();
            updateURLHash();
        }

        function setupEventListeners() {
            document.getElementById('activity-form').addEventListener('submit', addActivity);
            document.getElementById('activity-type').addEventListener('change', updateUnit);
            document.getElementById('share-btn').addEventListener('click', shareToday);
            document.addEventListener('keydown', handleKeydown);
            document.getElementById('activities-list').addEventListener('dragover', handleDragOver);
            document.getElementById('activities-list').addEventListener('drop', handleDrop);
        }

        function addActivity(e) {
            e.preventDefault();
            const type = document.getElementById('activity-type').value;
            const quantity = parseFloat(document.getElementById('quantity').value);
            const notes = document.getElementById('notes').value.trim();

            if (!type || isNaN(quantity) || quantity <= 0) return;

            const emissions = quantity * EMISSION_FACTORS[type].factor;
            const activity = {
                id: Date.now().toString(),
                type,
                quantity,
                emissions,
                notes,
                timestamp: new Date().toISOString()
            };

            activities.unshift(activity);
            saveActivities();
            updateDisplay();
            updateURLHash();
            e.target.reset();
            updateUnit();
        }

        function updateUnit() {
            const type = document.getElementById('activity-type').value;
            const unitEl = document.getElementById('unit');
            if (type && EMISSION_FACTORS[type]) {
                unitEl.textContent = EMISSION_FACTORS[type].unit;
            } else {
                unitEl.textContent = '';
            }
        }

        function deleteActivity(id) {
            activities = activities.filter(a => a.id !== id);
            saveActivities();
            updateDisplay();
            updateURLHash();
            if (selectedActivityId === id) selectedActivityId = null;
        }

        function handleKeydown(e) {
            if (e.key === 'Enter' && e.target.closest('form')) {
                document.getElementById('activity-form').dispatchEvent(new Event('submit'));
            }
            if (e.key === 'Delete' && selectedActivityId) {
                deleteActivity(selectedActivityId);
            }
        }

        // Drag and drop
        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDrop(e) {
            e.preventDefault();
            const afterElement = getDragAfterElement(e.currentTarget, e.clientY);
            const draggable = document.querySelector('.dragging');
            if (afterElement == null) {
                e.currentTarget.appendChild(draggable);
            } else {
                e.currentTarget.insertBefore(draggable, afterElement);
            }
            updateOrder();
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.activity:not(.dragging)')];
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        function updateOrder() {
            const activityEls = Array.from(document.querySelectorAll('.activity'));
            const newActivities = activityEls.map(el => {
                const id = el.dataset.id;
                return activities.find(a => a.id === id);
            }).filter(Boolean);
            activities = newActivities;
            saveActivities();
        }

        function loadActivities() {
            // Filter to current day, week, month based on timestamps
            const now = new Date();
            activities = activities.filter(activity => {
                const activityDate = new Date(activity.timestamp);
                const diffTime = now - activityDate;
                const diffDays = diffTime / (1000 * 3600 * 24);
                return diffDays <= 31; // Keep last month
            });
        }

        function saveActivities() {
            localStorage.setItem('carbon-activities', JSON.stringify(activities));
        }

        function updateDisplay() {
            const today = new Date().toDateString();
            const todayActivities = activities.filter(a => new Date(a.timestamp).toDateString() === today);
            const weekActivities = activities.filter(a => {
                const activityDate = new Date(a.timestamp);
                const weekAgo = new Date();
                weekAgo.setDate(weekAgo.getDate() - 7);
                return activityDate >= weekAgo;
            });

            // Update totals
            const dayTotal = todayActivities.reduce((sum, a) => sum + a.emissions, 0);
            const weekTotal = weekActivities.reduce((sum, a) => sum + a.emissions, 0);
            const monthTotal = activities.reduce((sum, a) => sum + a.emissions, 0);

            document.getElementById('day-total').textContent = dayTotal.toFixed(1) + ' kg';
            document.getElementById('week-total').textContent = weekTotal.toFixed(1) + ' kg';
            document.getElementById('month-total').textContent = monthTotal.toFixed(1) + ' kg';

            // Update progress
            const progressPercent = Math.min((weekTotal / WEEKLY_TARGET) * 100, 100);
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            progressFill.style.width = progressPercent + '%';
            progressFill.className = 'progress-fill ' + (progressPercent < 70 ? 'safe' : progressPercent < 90 ? 'warning' : 'danger');
            progressText.textContent = weekTotal.toFixed(1) + ' / ' + WEEKLY_TARGET + ' kg (' + progressPercent.toFixed(0) + '% of target)';

            // Update activities list
            const list = document.getElementById('activities-list');
            list.innerHTML = todayActivities.map(activity => `
                <li role="listitem" class="activity ${activity.type}" draggable="true" data-id="${activity.id}"
                    tabindex="0" aria-label="Activity: ${activity.type}, ${activity.quantity}${EMISSION_FACTORS[activity.type].unit}, ${activity.emissions.toFixed(2)}kg CO2">
                    <div class="activity-header">
                        <div>
                            <strong>${activity.type.charAt(0).toUpperCase() + activity.type.slice(1)}</strong>
                            <div class="activity-emissions" style="color: ${CATEGORY_COLORS[activity.type]}">${activity.emissions.toFixed(2)} kg</div>
                        </div>
                        <div>
                            <button class="delete-btn" onclick="deleteActivity('${activity.id}')" aria-label="Delete this activity">√ó</button>
                        </div>
                    </div>
                    <div class="activity-details">${activity.quantity} ${EMISSION_FACTORS[activity.type].unit} ${activity.notes ? '- ' + activity.notes : ''}</div>
                </li>
            `).join('');

            // Add drag listeners to new activities
            document.querySelectorAll('.activity').forEach(activityEl => {
                activityEl.addEventListener('dragstart', () => activityEl.classList.add('dragging'));
                activityEl.addEventListener('dragend', () => activityEl.classList.remove('dragging'));
                activityEl.addEventListener('click', () => selectActivity(activityEl.dataset.id));
                activityEl.addEventListener('keydown', (e) => {
                    if (e.key === 'Delete') deleteActivity(activityEl.dataset.id);
                });
            });

            updateStats(todayActivities, weekActivities);
        }

        function selectActivity(id) {
            document.querySelectorAll('.activity').forEach(el => el.classList.remove('selected'));
            document.querySelector(`[data-id="${id}"]`)?.classList.add('selected');
            selectedActivityId = id;
        }

        function updateStats(todayActivities, weekActivities) {
            if (todayActivities.length === 0) return;

            // Highest category
            const categoryTotals = {};
            todayActivities.forEach(a => {
                categoryTotals[a.type] = (categoryTotals[a.type] || 0) + a.emissions;
            });
            const highestCategory = Object.entries(categoryTotals).reduce((a, b) => a[1] > b[1] ? a : b)[0];
            document.getElementById('highest-category').textContent = highestCategory.toUpperCase();

            // Daily average
            const days = Math.max(1, new Set(activities.map(a => new Date(a.timestamp).toDateString())).size);
            const dailyAvg = (weekActivities.reduce((sum, a) => sum + a.emissions, 0) / 7).toFixed(1);
            document.getElementById('daily-average').textContent = dailyAvg + ' kg/day';

            // Carbon saved vs baseline (70kg/week)
            const baseline = 70;
            const saved = Math.max(0, baseline - weekActivities.reduce((sum, a) => sum + a.emissions, 0)).toFixed(1);
            document.getElementById('carbon-saved').textContent = '+' + saved + ' kg saved';
        }

        function shareToday() {
            const today = new Date().toDateString();
            const todayActivities = activities.filter(a => new Date(a.timestamp).toDateString() === today);
            const shareData = btoa(JSON.stringify(todayActivities));
            const url = new URL(window.location);
            url.hash = shareData;
            navigator.clipboard.writeText(url.toString()).then(() => {
                alert('Today\'s log copied to clipboard!');
            });
        }

        function updateURLHash() {
            const hash = window.location.hash.slice(1);
            if (hash) {
                try {
                    const sharedActivities = JSON.parse(atob(hash));
                    // Load shared activities as read-only snapshot
                    displaySharedActivities(sharedActivities);
                } catch (e) {
                    console.warn('Invalid share hash');
                }
            }
        }

        function displaySharedActivities(sharedActivities) {
            // Simplified display for shared view
            const list = document.getElementById('activities-list');
            list.innerHTML = '<h3>üìã Shared Snapshot</h3>' + sharedActivities.map(activity => `
                <li class="activity ${activity.type}">
                    <div><strong>${activity.type}</strong>: ${activity.emissions.toFixed(2)}kg</div>
                    <div>${activity.quantity}${EMISSION_FACTORS[activity.type].unit}</div>
                </li>
            `).join('');
        }

        // Expose deleteActivity globally for onclick
        window.deleteActivity = deleteActivity;

        // Initialize app
        init();
    </script>
</body>
</html>