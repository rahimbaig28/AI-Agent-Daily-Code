Pocket Ledger: Inline Budget Snapshot

- Overall
  - Single-page personal budgeting dashboard focused on “this month at a glance.”
  - One self-contained HTML file with inline CSS and vanilla JS only; no external assets.
  - All data persisted with localStorage under a single app-specific key.
  - Responsive layout for mobile, tablet, and desktop; keyboard- and screen-reader-friendly.

- Core Concepts & Data Model
  - Track recurring monthly income sources and expense categories.
  - Track individual transactions (date, category, description, amount, type: income/expense).
  - Maintain computed summary: total income, total expenses, net, savings rate, category totals.
  - Support multiple “budgets” (profiles) stored in localStorage; user can switch between them.

- Layout Structure
  - Top fixed header:
    - App title “Pocket Ledger”.
    - Budget selector (dropdown) + buttons: “New Budget”, “Rename”, “Delete”.
    - Net result pill: shows “Net: +$X” or “Net: -$X” with color coding.
    - Theme toggle button (Light / Dark / Auto).
  - Main area split into:
    - Left column: “Quick Add Transaction” form and summaries.
    - Right column: “Transactions Table” with filters and inline editing.
  - Optional print-friendly view accessible via a dedicated “Print Summary” button that opens a print-optimized preview section (CSS @media print).

- Theme & Appearance
  - Implement light and dark themes using CSS variables on :root and [data-theme] attributes.
  - On first load, use OS/browser preference via prefers-color-scheme to set initial theme when theme mode is “Auto”.
  - Store user theme mode (light/dark/auto) in localStorage; allow override via theme toggle.
  - Provide sufficient contrast and clear color coding for income vs expense vs net.
  - Use a simple font stack (system fonts) and spacing for readability.

- Accessibility & Keyboard Support
  - All interactive elements reachable via Tab; visible focus outlines.
  - Use semantic HTML: <header>, <main>, <section>, <form>, <table>, <button>, etc.
  - Associate labels with inputs via <label for> and aria-describedby where needed.
  - Provide aria-live region for key status messages (e.g., “Transaction added”, “Undo complete”).
  - Keyboard shortcuts:
    - `Ctrl+N` / `Cmd+N`: focus “Quick Add Transaction” form.
    - `Ctrl+Z` / `Cmd+Z`: Undo last change (if available).
    - `Ctrl+Y` / `Cmd+Y`: Redo (if available).
    - `Ctrl+F` / `Cmd+F`: focus transaction search/filter input.

- Budgets Management
  - Budget selector dropdown showing existing budget names.
  - “New Budget” opens a small inline dialog (no modal window library) prompting for name; validates non-empty and uniqueness.
  - “Rename” allows changing current budget name with validation.
  - “Delete” requires confirmation; removes budget from localStorage and switches to another or creates a blank one if none remain.
  - Each budget stores:
    - Name, created timestamp.
    - Categories list (with type income/expense).
    - Recurring items (optional).
    - Transactions list.
    - Undo/redo stacks (see below).

- Categories & Recurring Items
  - “Categories” section:
    - Simple list showing category name, type (income/expense), and monthly target (optional number).
    - Inline add/edit/delete with minimal controls.
  - “Recurring Items” section:
    - Each item: name, amount, category, type (income/expense), due day (1–31).
    - Info-only for MVP: does not auto-generate transactions, but shows in summary with expected monthly totals.
    - Option “Generate this month’s recurring transactions” button:
      - On click, creates non-duplicate transactions for current month based on recurring items; uses a flag to avoid re-adding duplicates.

- Quick Add Transaction Form
  - Inputs:
    - Date (default to today; HTML date input).
    - Type toggle (Income / Expense) as two radio buttons.
    - Category dropdown filtered by selected type; includes “+ New Category” at bottom.
    - Description (short text).
    - Amount (number with step=0.01, min>0).
  - Primary “Add” button:
    - Validates inputs and shows error summaries inline.
    - On success, adds transaction to current budget, updates summaries, pushes to undo stack, clears description/amount while leaving date/type.
  - “Add & Stay Open” behavior: form does not collapse after adding, for rapid entry.

- Transactions Table
  - Scrollable table listing transactions for current budget.
  - Columns: Date, Type, Category, Description, Amount, Actions.
  - Features:
    - Sort by Date and Amount via clickable column headers; show sort direction indicator.
    - Filter row above table:
      - Text search (matches description and category).
      - Category dropdown filter.
      - Type filter (All / Income / Expense).
      - Date range (From / To).
    - Inline editing:
      - Clicking a row’s “Edit” button turns cells into inputs.
      - “Save” and “Cancel” buttons appear for edited row.
    - Row delete button with confirmation.
    - Sticky header for table on tall screens.

- Summary Panels
  - “This Month Snapshot” section:
    - Total income, total expenses, net.
    - Savings rate (% = (income - expenses) / income) when income>0.
    - Per-category bar indicators:
      - For expenses: spent vs target (if set) as simple progress bars.
      - For income: received vs expected from recurring items (if defined).
  - “Trend Mini-Chart”:
    - Simple, non-canvas implementation: small horizontal bar chart or sparkline using a series of <div> bars representing weekly net amounts for current month (all computed in JS, rendered via CSS width/height).
    - Hover tooltip via title attribute showing exact amounts.

- Undo/Redo System
  - Maintain two stacks per budget in memory (and mirror to localStorage after each mutating action):
    - Undo stack: array of action objects with enough info to reverse (e.g., type: "addTransaction", payload, previousStateFragment).
    - Redo stack: cleared on new action; used when user explicitly performs redo.
  - Actions covered:
    - Add, edit, delete transaction.
    - Add, edit, delete category.
    - Add, edit, delete recurring item.
    - Generate recurring transactions.
  - UI Controls:
    - Undo and Redo buttons in header, disabled when no actions available.
    - Keyboard shortcuts as specified above update these buttons’ enabled states.
  - After any undo/redo:
    - Recompute summaries.
    - Update table and summaries.
    - Announce change via aria-live (e.g., “Undo: deleted transaction restored”).

- Print-Friendly View
  - Dedicated “Print Summary” button in header.
  - When clicked:
    - Switches app into a “print mode” state (e.g., data-print-mode attribute) showing a condensed, one-column summary:
      - Current budget name and period.
      - Overall monthly totals (income, expenses, net, savings rate).
      - Category totals with optional targets.
      - List of recurring items.
      - Optionally, last 20 transactions, not all, to keep page reasonable.
    - Hide controls like buttons, forms, filters in print mode via CSS @media print.
  - Normal screen layout remains usable in print mode; print-specific tweaks only in print media query.
  - “Exit Print Mode” button to return to interactive layout (for users who entered print mode but chose not to print).

- Persistence & Initialization
  - On load:
    - Read budgets list and last active budget ID from localStorage.
    - If none found, create a default “My First Budget” with a few starter categories.
    - Read theme preference and apply (or auto-detect).
  - After any state change that affects budgets or theme:
    - Serialize to JSON and store in localStorage.
  - Provide a “Backup / Restore” section:
    - Backup button: shows a readonly textarea with JSON export of all budgets; user can copy manually.
    - Restore button: allows user to paste JSON into a textarea; validates structure before replacing stored data; confirmation required.

- Error Handling & Validation
  - Client-side validation for all forms:
    - Required fields, numeric ranges, date validity.
  - Non-blocking, inline error messages near fields and summary message at top of form if needed.
  - Defensive coding around localStorage (try/catch, fallback to in-memory if localStorage not available; show a warning banner if persistence is disabled).

- Implementation Notes (for the developer)
  - Use a single <script> block at bottom of body and a single <style> block in head.
  - Maintain a clear JS state object (e.g., appState) mirroring what is in localStorage.
  - Re-render only parts of the DOM that change: summaries, table, budget selector, etc.
  - Avoid external fonts/icons; use Unicode symbols or simple text for icons (e.g., “↺” for Undo, “↻” for Redo, “☾/☼/A” for theme mode).

(Generated: 2026-01-12T04:48:43.881334Z, seed=85449, theme=finance & budgeting, extras=dark/light auto theme, undo/redo, print-friendly view, kind=html)
