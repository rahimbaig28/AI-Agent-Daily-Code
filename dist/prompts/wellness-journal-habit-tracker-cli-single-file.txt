Wellness Journal & Habit Tracker (CLI, Single File)

- Purpose:
  - Create a single-file, terminal-based **health & wellness journaling and habit tracking app**.
  - Let users log daily wellness entries (mood, sleep, movement, nutrition, mindfulness, notes).
  - Provide simple stats, streaks, and a print-friendly “weekly summary” view.
  - Support safe persistence via a single JSON file in the working directory.

- Platform & constraints:
  - Single Python 3 script, standard library only (e.g., json, datetime, textwrap, pathlib, argparse, copy).
  - Runs entirely in the terminal (no GUI, no external services).
  - Uses a simple text-based menu with clear keyboard navigation.
  - Designed to be implemented in < 1000 LOC.

- Data model:
  - Store data in a single JSON file, e.g., "wellness_journal.json".
  - Top-level structure:
    - "version": int
    - "entries": dict keyed by ISO date string "YYYY-MM-DD".
    - "settings": dict (e.g., default goals).
    - "undo_stack": list of past states or operations (optional to persist).
  - Each entry for a given date:
    - "date": ISO string.
    - "mood": integer 1–5.
    - "sleep_hours": float.
    - "movement_minutes": int.
    - "water_glasses": int.
    - "mindfulness_minutes": int.
    - "nutrition_quality": integer 1–5 (subjective rating).
    - "tags": list of short strings (e.g., ["stress", "travel"]).
    - "notes": free-text string.
  - Settings:
    - "daily_goals": dict:
      - "movement_minutes": int (e.g., 30).
      - "water_glasses": int (e.g., 8).
      - "mindfulness_minutes": int (e.g., 10).
    - "first_run_completed": bool.

- Startup behavior:
  - On launch, parse optional CLI args:
    - "--file PATH": custom JSON data file.
    - "--today DATE": override today’s date for testing (YYYY-MM-DD).
  - If file does not exist:
    - Initialize default structure with empty "entries", default "daily_goals", and version 1.
  - Load JSON, with basic validation and fallback to safe defaults if corrupted (do not crash without explanation).
  - Determine "today" based on system date or override.

- Main loop & navigation:
  - Show a **main menu** as numbered options:
    - [1] Log / edit today’s entry
    - [2] View a date’s entry
    - [3] Weekly summary (print-friendly)
    - [4] Streaks & stats
    - [5] Undo last change
    - [6] Settings
    -  Save & exit
  - Accept single-key or line-number input (e.g., "1", "2", "0").
  - On invalid input, show brief error and re-display the same menu.
  - Allow "q" at any point to cancel current action and go back one level.

- Logging / editing today’s entry:
  - For each field, prompt with current value (if any) in brackets:
    - Mood (1–5, with textual hints: 1=very low, 5=excellent).
    - Sleep hours (0–24, float).
    - Movement minutes (0+).
    - Water glasses (0+).
    - Mindfulness minutes (0+).
    - Nutrition quality (1–5).
    - Tags (comma-separated or blank).
    - Notes (multi-line with clear finish instruction, e.g., "End notes with a single '.' on a line").
  - Allow pressing Enter to keep existing value.
  - Basic validation (numeric ranges; reject invalid input with a short message and re-prompt).
  - After entry is edited, show a compact summary for confirmation:
    - If user confirms, record as a new state on the undo stack and save the file.
    - If user cancels, revert to previous values.

- View a date’s entry:
  - Prompt for date "YYYY-MM-DD", with helpers:
    - Accept shortcuts like "t" for today, "y" for yesterday.
  - If entry exists:
    - Render a clean, monospaced-friendly block:
      - Date header.
      - Line for mood (with a brief textual label).
      - Sleep, movement, water, mindfulness, nutrition.
      - Bullet-like line of tags.
      - Notes wrapped to terminal width (use textwrap).
  - If entry missing, show "No entry for this date" and offer to:
    - [1] Create it now (jump into logging flow for that date).
    -  Back to menu.

- Weekly summary (print-friendly view):
  - Default to the current week (Mon–Sun based on today), with option to navigate:
    - "p" for previous week, "n" for next week (if not in the future).
    - "d" to specify an arbitrary week by entering any date in that week.
  - For the chosen week, show a **compact table-like layout**:
    - One line per day, aligned columns for:
      - Date (short form, e.g., "Mon 06").
      - Mood (1–5 or "–").
      - Sleep hours.
      - Movement minutes (with mark "✓" if goal met).
      - Water (with "✓" if goal met).
      - Mindfulness minutes (with "✓" if goal met).
    - At bottom, include:
      - Count of days with all goals met.
      - Average mood and average sleep.
  - Design layout with fixed-width columns for readability and printing.
  - Provide options:
    - "p"/"n"/"d" to change week.
    - "x" to export this weekly summary to a plain-text file (e.g., "weekly_summary_YYYY-WW.txt") suitable for printing.

- Streaks & stats:
  - Compute streaks based on:
    - Days in a row with at least one field filled (journal streak).
    - Days in a row all main goals met (goal streak).
  - Show:
    - Current journal streak length and longest journal streak.
    - Current goal streak length and longest goal streak.
    - 7-day and 30-day averages for:
      - Mood.
      - Sleep hours.
      - Movement minutes.
      - Water glasses.
  - Stats should handle gaps gracefully (skip missing values).

- Undo/redo behavior:
  - Maintain an in-memory **undo stack** of operations:
    - Each change pushes a snapshot of the entire "entries" dict or a compact operation descriptor (e.g., ("set_entry", date, old_entry, new_entry)).
  - For simplicity:
    - Implement **undo** only in UI (no redo).
    - Cap undo history length (e.g., last 20 changes) to limit memory.
  - When the user selects "Undo last change":
    - If stack is empty, inform user.
    - Otherwise, pop last change and revert the affected entries.
    - Save file immediately after undo.
    - Show a brief one-line description of what was undone (e.g., "Reverted changes to 2026-01-06 entry").

- Settings:
  - Menu items:
    - [1] Edit daily goals (movement, water, mindfulness).
    - [2] Toggle brief tips display.
    -  Back.
  - Changing goals:
    - Prompt for each with current value in brackets.
    - On confirmation, push to undo stack and save.
  - Brief tips:
    - If enabled, after saving today’s entry, show 1–2 short non-medical wellness tips based on data (e.g., if movement_minutes is 0, suggest a short walk).
    - Tips must be purely informational and generic, not medical advice.

- Accessibility & keyboard considerations:
  - Fully operable via keyboard:
    - Single-character commands, Enter to confirm.
    - Always show available commands at the bottom of each screen (e.g., " Back  [q] Cancel  [Enter] Continue").
  - Make prompts explicit and consistent:
    - For yes/no, accept "y"/"n" and full words ("yes"/"no") case-insensitively.
  - Provide an optional "high-contrast" text mode in settings:
    - In normal mode, minimal use of ASCII decoration.
    - In high-contrast mode, use stronger separators (e.g., "====", "----") and clear section headers.
  - Avoid reliance on color; assume plain monochrome terminals.

- Persistence and file handling:
  - All data stored in a single JSON file; atomic save:
    - Write to a temporary file and then replace the old file to reduce corruption risk.
  - Before saving, strip trailing whitespace from notes.
  - Provide a basic "backup" feature:
    - Option in settings: "Create backup now".
    - Copies current JSON file to "wellness_journal_backup_YYYYMMDD_HHMMSS.json" in the same directory.

- Error handling & robustness:
  - Wrap file I/O in try/except with clear, user-visible messages:
    - If reading fails, offer:
      - [1] Create a new empty data file.
      - [2] Exit and let me fix it manually.
  - Ensure that any keyboard interrupt (Ctrl+C) triggers a gentle shutdown:
    - Ask whether to save current state (if modified) before exit.

- Internal structure (suggested, not enforced):
  - Functions for:
    - load_data(path), save_data(data, path)
    - show_main_menu(), handle_log_today(), handle_view_date(), etc.
    - compute_week_range(today), compute_stats(data), compute_streaks(data, goals)
    - render_entry(entry), render_week_summary(...)
  - Use datetime and timedelta for date operations.

- Non-goals & scope:
  - No network access, no external APIs, no medical recommendations.
  - No GUI toolkits; strictly text-based.
  - No user accounts; assume a single local user per file.

(Generated: 2026-01-09T04:38:50.008681Z, seed=16755, theme=health & wellness, extras=ARIA-compliant components, undo/redo, print-friendly view, kind=py)
