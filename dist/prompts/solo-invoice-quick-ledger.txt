Solo Invoice & Quick Ledger

- Purpose: single-file Python 3 CLI utility for micro/small-business invoicing and simple ledger tracking; creates, lists, edits, and exports invoices and maintains a running cash ledger in a single JSON file for persistence.
- File type: single-file Python 3 script (standard library only). No external files except the persistent JSON data file created/updated by the script.
- Invocation: run as a CLI tool (python solo_invoice.py [command] [options]); includes an interactive TUI mode when run without arguments.
- Data persistence: store all data in a single JSON file (default ./solo_invoice_data.json). Provide --data PATH to change location. On first run create file with structure: { "invoices": [], "ledger": [], "meta": { "next_invoice_id": 1 } }.
- Core entities:
  - Invoice: id (int), date (ISO 8601), customer_name (str), items (list of {description, qty (float), unit_price (float)}), tax_rate (percent as float), status ("draft","sent","paid"), total (computed), notes (str).
  - Ledger entry: id (int), date (ISO 8601), type ("invoice","payment","expense","adjustment"), amount (float, positive for income, negative for expense), reference (invoice id or text), balance_after (computed).
- Required commands (CLI):
  - create-invoice: prompts (or accepts flags) to add customer, add one-or-more items (repeatable), tax_rate, notes; computes totals; saves as draft and appends a corresponding ledger entry only when marked "paid".
  - list-invoices: supports filters --status, --customer, --from-date, --to-date, --min-amount, --sort (date/total/id).
  - view-invoice <id>: display invoice full details and computed totals.
  - edit-invoice <id>: open an inline interactive editor (text prompts) to modify customer, items, tax, status, notes; changes recalc totals; if status changed to "paid" create ledger payment entry automatically; if changed from "paid" to other remove related ledger payment (with confirmation).
  - mark-paid <id> [--date DATE] [--amount AMOUNT]: record full or partial payment; create ledger entry and update invoice.status ("paid" when fully paid, "partial" allowed).
  - add-ledger: manual ledger entry for expenses/adjustments with fields date, type, amount, note.
  - ledger: show ledger with running balance, filters --from-date/--to-date/--type.
  - export-invoice <id> --csv|--txt: export invoice to a simple text or CSV file named invoice_<id>.txt/csv.
  - export-ledger --csv [--from-date --to-date]: write ledger rows to CSV.
  - undo / redo: support single-level undo/redo for data-modifying commands using an in-file history stack (store last snapshot and next snapshot inside the same JSON under "meta.history" limited to 10 entries). Provide commands undo and redo that revert or reapply last change.
  - backup: write a timestamped copy of data JSON to ./backups/.
- Interactive TUI mode (when no args):
  - Keyboard-first menu (numbered choices) with options: Create Invoice, List Invoices, View Ledger, Undo, Redo, Settings, Exit.
  - All interactive prompts accept keyboard navigation and default values shown in brackets; keyboard shortcuts: c=create, l=list, v=view, p=mark-paid, u=undo, r=redo, q=quit.
- Accessibility & UX:
  - Clear plain-text output suitable for screen readers (no colors required).
  - All prompts accept keyboard-only input; provide explicit confirmation prompts for destructive actions (delete invoice, remove payment).
  - Use ISO 8601 dates; accept shortcuts like "today" and "YYYY-MM-DD".
  - Provide --quiet and --yes flags for scripting/automation to skip confirmations.
- Validation & safety:
  - Validate numeric inputs and dates; reject negative quantities or invalid tax rates.
  - Before destructive edits or undo/redo that would drop data, require explicit confirmation unless --yes is supplied.
  - Atomic saves: write to a temp file then rename to avoid corruption.
- Implementation details:
  - Use argparse for CLI parsing and detect interactive mode.
  - Use json, datetime, decimal (for currency arithmetic), tempfile, shutil, os, sys modules only.
  - Use Decimal for money and format outputs with two decimal places.
  - Keep code modular with functions: load_data, save_data, create_invoice_interactive, list_invoices, view_invoice, edit_invoice, mark_paid, add_ledger, show_ledger, export_invoice, export_ledger, push_history, undo, redo, interactive_menu.
  - Ensure the entire script is implementable under ~1000 lines.
- Testing hooks:
  - Provide --seed TEST_ID that creates sample data (3 invoices, mixed statuses, some ledger entries) for quick manual testing.
  - Provide --dry-run option for commands that shows planned changes without writing.
- Edge cases:
  - Partial payments tracked per-invoice with a payments list and balance remaining.
  - When exporting, include invoice item lines and a final total row; CSV must include header row.
- Deliverable expectations for implementer:
  - Single .py script implementing above commands and interactive mode.
  - Inline usage help and examples surfaced via --help.

(Generated: 2025-12-12T01:26:52.970712Z, seed=50713, theme=small business utilities, extras=undo/redo, ARIA-compliant components, keyboard-first UX, kind=py)
