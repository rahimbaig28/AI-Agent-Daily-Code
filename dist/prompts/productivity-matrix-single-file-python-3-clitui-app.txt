Productivity Matrix — single-file Python 3 CLI+TUI app

- Purpose: A compact, single-file Python 3 script that provides a keyboard-friendly terminal productivity matrix for planning and tracking tasks across Priority (High/Med/Low) vs. Timebox (Now/Today/ThisWeek). The app is optimized for quick keyboard workflows, undo/redo, simple persistence to a local JSON file, printable plain-text report, and a responsive ASCII grid view that adjusts to terminal width.

- Runtime & dependencies: Must run on Python 3.8+ using only the standard library (no external packages).

- File: one .py file; when run it opens an interactive terminal UI (curses on Unix; fallback to simple-line mode on Windows if curses unavailable).

Core features (must be implementable in ~500-800 LOC)
- Data model:
  - Task object: id (UUID4), title (string), notes (string), priority ∈ {High,Med,Low}, timebox ∈ {Now,Today,ThisWeek}, created_at (ISO), updated_at (ISO), done (bool), due_date (optional ISO).
  - State container with history stack for undo and redo (store diffs or deep copies; limit history to 100 steps).
  - Persist state to a JSON file named .productivity_matrix.json in the user's home directory on every state-changing action and on graceful exit.

- Startup:
  - Load existing JSON file if present and validate; if corrupted, offer to backup and start fresh.
  - Optionally accept a command-line arg --file PATH to override persistence file.

- Main UI (curses if available):
  - Display a 3x3 ASCII grid: columns = Timebox (Now / Today / ThisWeek), rows = Priority (High / Med / Low).
  - Each cell lists up to N task lines (N computed from terminal height minus header/footer). If overflow, show "+X more" and allow a cell-focus view to scroll cell contents.
  - Header shows app name, current persistence file, number of tasks, and current filter (search or show/hide done).
  - Footer shows single-key commands (Add A, Edit E, Toggle Done Space, Delete D, Move M, Search /, Undo Z, Redo Y, Save S, Print P, Quit Q, Help H).

- Keyboard interactions:
  - Arrow keys or hjkl to move cell focus; Enter opens focused cell in detail view.
  - A: add task — inline modal accepts title (required), optional notes, choose priority and timebox (defaults based on current focused cell), optional due date (YYYY-MM-DD). Validate input.
  - E: edit selected task fields.
  - Space: toggle done/undone for selected task.
  - D: delete selected task with confirmation (Y/N).
  - M: move selected task — quick picker to change priority/timebox.
  - / : search — incremental filter by substring in title/notes; highlight matches; escapes clears.
  - F: filter menu — toggle show/hide done, filter by priority or timebox.
  - Z: undo last action; Y: redo.
  - P: print-friendly export — write plain-text matrix report to stdout or to a user-specified file; the report should be width-aware for printing and include timestamps and counts.
  - S: manual save to persistence file (auto-save also occurs).
  - H: help screen listing keys and brief usage.
  - Q: quit (prompt to save if there are unsaved changes).

- Accessibility & keyboard support:
  - Full keyboard-driven flow; all modals accept Enter to confirm and Esc to cancel.
  - Colors optional: use terminal color sequences if available; ensure monochrome fallback.
  - Focus indicator for current cell and selected task (reverse video or marker).

- Views & responsiveness:
  - Grid view adapts to terminal width: if width too small to show three columns, fall back to two or single-column stacked layout while preserving keyboard navigation.
  - Cell-focus view displays full task list for that cell with paging and task selection for operations.
  - Compact view for narrow terminals: only titles shown, longer titles truncated with ellipsis.

- Undo/Redo
  - Record user actions that mutate state (add/edit/delete/toggle/move) to a history stack; implement undo/redo commands with clear user feedback (status line message).
  - Persist history length and allow restoring history across sessions (optional; if persisted, limit size).

- Persistence & data safety:
  - Atomic save: write to a temporary file then rename to avoid corruption.
  - Create a timestamped backup when detecting a schema mismatch or corrupted JSON.
  - Simple schema version field; migration function stub for future changes.

- Print-friendly view & export:
  - P key produces a plain-text matrix with headings and tasks grouped by cell; each task prints id, title, done flag, due date, and first line of notes.
  - Option to export to a user-specified file via prompt.

- CLI utilities:
  - If invoked with --export FILE [--format text/json], run non-interactive export of current data and exit.
  - If invoked with --import FILE, attempt to import tasks from a JSON file (merge or replace prompt).

- Error handling & robustness:
  - Graceful handling for terminal resize (redraw layout).
  - If curses unavailable (e.g., Windows without curses), fall back to simple line-based menu mode implementing the same features via numbered menus and single-key commands.

- Tests & developer hooks:
  - Include a --seed N option to prepopulate the app with deterministic dummy tasks for manual testing (useful for verifying grid overflow, print view, undo/redo).
  - Include inline help and an accessible README string shown with --help.

- Implementation notes for developer:
  - Use only standard library modules: json, os, sys, uuid, datetime, shutil, tempfile, argparse, curses (with fallback), tty, termios for finer input on UNIX if desired.
  - Keep UI and state logic modular within the single file: clearly separated functions for persistence, history, UI rendering, input handling, and commands.
  - Ensure total code size is implementable under ~1000 lines; design data structures and UI loops for clarity and maintainability.

(Generated: 2025-12-19T01:26:52.864284Z, seed=69312, theme=personal productivity, extras=undo/redo, responsive grid, print-friendly view, kind=py)
